Args in experiment:
Namespace(is_training=1, model_id='Exchange_96_720', model='DLinear', data='custom', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=8, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=True)
Use GPU: cuda:0
>>>>>>>start training : Exchange_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11379
val 1023
test 2765
	iters: 100, epoch: 1 | loss: 0.8888025
	speed: 0.0354s/iter; left time: 500.2201s
	iters: 200, epoch: 1 | loss: 0.5751256
	speed: 0.0050s/iter; left time: 70.6159s
	iters: 300, epoch: 1 | loss: 0.7011504
	speed: 0.0039s/iter; left time: 54.2696s
	iters: 400, epoch: 1 | loss: 0.6669039
	speed: 0.0037s/iter; left time: 51.4736s
	iters: 500, epoch: 1 | loss: 0.6126854
	speed: 0.0040s/iter; left time: 55.2366s
	iters: 600, epoch: 1 | loss: 0.4837398
	speed: 0.0044s/iter; left time: 59.2993s
	iters: 700, epoch: 1 | loss: 0.4848324
	speed: 0.0041s/iter; left time: 54.9114s
	iters: 800, epoch: 1 | loss: 0.6449338
	speed: 0.0033s/iter; left time: 43.7731s
	iters: 900, epoch: 1 | loss: 0.6907076
	speed: 0.0032s/iter; left time: 42.7934s
	iters: 1000, epoch: 1 | loss: 0.5173011
	speed: 0.0037s/iter; left time: 49.5761s
	iters: 1100, epoch: 1 | loss: 0.6970736
	speed: 0.0031s/iter; left time: 40.6028s
	iters: 1200, epoch: 1 | loss: 0.5724974
	speed: 0.0037s/iter; left time: 48.6601s
	iters: 1300, epoch: 1 | loss: 0.5593406
	speed: 0.0035s/iter; left time: 45.2862s
	iters: 1400, epoch: 1 | loss: 0.5555677
	speed: 0.0032s/iter; left time: 41.5478s
Epoch: 1 cost time: 8.545443534851074
Epoch: 1, Steps: 1422 | Train Loss: 0.6424873 Vali Loss: 0.4651812 Test Loss: 0.6539903
Validation loss decreased (inf --> 0.465181).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.8032705
	speed: 0.0587s/iter; left time: 745.1759s
	iters: 200, epoch: 2 | loss: 0.6141752
	speed: 0.0033s/iter; left time: 41.2589s
	iters: 300, epoch: 2 | loss: 0.6704234
	speed: 0.0034s/iter; left time: 42.0706s
	iters: 400, epoch: 2 | loss: 0.5322734
	speed: 0.0034s/iter; left time: 42.3632s
	iters: 500, epoch: 2 | loss: 0.4922684
	speed: 0.0032s/iter; left time: 39.2536s
	iters: 600, epoch: 2 | loss: 0.6700326
	speed: 0.0032s/iter; left time: 39.6395s
	iters: 700, epoch: 2 | loss: 0.6903536
	speed: 0.0032s/iter; left time: 38.2376s
	iters: 800, epoch: 2 | loss: 0.6243451
	speed: 0.0031s/iter; left time: 37.3867s
	iters: 900, epoch: 2 | loss: 0.5705470
	speed: 0.0033s/iter; left time: 38.7046s
	iters: 1000, epoch: 2 | loss: 0.5749289
	speed: 0.0034s/iter; left time: 40.0779s
	iters: 1100, epoch: 2 | loss: 0.5705952
	speed: 0.0031s/iter; left time: 36.3838s
	iters: 1200, epoch: 2 | loss: 0.6267465
	speed: 0.0035s/iter; left time: 40.0604s
	iters: 1300, epoch: 2 | loss: 0.7331942
	speed: 0.0035s/iter; left time: 40.7492s
	iters: 1400, epoch: 2 | loss: 0.5166622
	speed: 0.0031s/iter; left time: 35.7454s
Epoch: 2 cost time: 6.05250358581543
Epoch: 2, Steps: 1422 | Train Loss: 0.6198580 Vali Loss: 0.5014899 Test Loss: 0.6527682
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.7471563
	speed: 0.0573s/iter; left time: 646.4264s
	iters: 200, epoch: 3 | loss: 0.4324871
	speed: 0.0031s/iter; left time: 34.3320s
	iters: 300, epoch: 3 | loss: 0.6021332
	speed: 0.0035s/iter; left time: 38.6208s
	iters: 400, epoch: 3 | loss: 0.4168049
	speed: 0.0031s/iter; left time: 34.0058s
	iters: 500, epoch: 3 | loss: 0.6839108
	speed: 0.0033s/iter; left time: 36.1191s
	iters: 600, epoch: 3 | loss: 0.5902650
	speed: 0.0033s/iter; left time: 35.0910s
	iters: 700, epoch: 3 | loss: 0.6442068
	speed: 0.0030s/iter; left time: 31.8697s
	iters: 800, epoch: 3 | loss: 0.5393573
	speed: 0.0033s/iter; left time: 34.8089s
	iters: 900, epoch: 3 | loss: 0.6979632
	speed: 0.0033s/iter; left time: 34.6324s
	iters: 1000, epoch: 3 | loss: 0.4623392
	speed: 0.0031s/iter; left time: 31.9851s
	iters: 1100, epoch: 3 | loss: 0.4599785
	speed: 0.0032s/iter; left time: 33.2906s
	iters: 1200, epoch: 3 | loss: 0.6314660
	speed: 0.0035s/iter; left time: 35.4026s
	iters: 1300, epoch: 3 | loss: 0.6961905
	speed: 0.0031s/iter; left time: 31.5801s
	iters: 1400, epoch: 3 | loss: 0.4716667
	speed: 0.0031s/iter; left time: 31.0156s
Epoch: 3 cost time: 5.888219833374023
Epoch: 3, Steps: 1422 | Train Loss: 0.6154492 Vali Loss: 0.4493961 Test Loss: 0.6455984
Validation loss decreased (0.465181 --> 0.449396).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.4624023
	speed: 0.0580s/iter; left time: 571.2290s
	iters: 200, epoch: 4 | loss: 0.8098028
	speed: 0.0036s/iter; left time: 35.1490s
	iters: 300, epoch: 4 | loss: 0.6771371
	speed: 0.0031s/iter; left time: 29.4586s
	iters: 400, epoch: 4 | loss: 0.7001708
	speed: 0.0030s/iter; left time: 28.2233s
	iters: 500, epoch: 4 | loss: 0.5279677
	speed: 0.0033s/iter; left time: 31.1361s
	iters: 600, epoch: 4 | loss: 0.5852707
	speed: 0.0030s/iter; left time: 28.2286s
	iters: 700, epoch: 4 | loss: 0.4891113
	speed: 0.0030s/iter; left time: 27.8192s
	iters: 800, epoch: 4 | loss: 0.6272897
	speed: 0.0034s/iter; left time: 31.4017s
	iters: 900, epoch: 4 | loss: 0.6116763
	speed: 0.0032s/iter; left time: 29.0028s
	iters: 1000, epoch: 4 | loss: 0.7090768
	speed: 0.0030s/iter; left time: 26.5242s
	iters: 1100, epoch: 4 | loss: 0.5129563
	speed: 0.0035s/iter; left time: 31.0982s
	iters: 1200, epoch: 4 | loss: 0.5985270
	speed: 0.0030s/iter; left time: 26.5989s
	iters: 1300, epoch: 4 | loss: 0.7913579
	speed: 0.0030s/iter; left time: 26.3315s
	iters: 1400, epoch: 4 | loss: 0.6003684
	speed: 0.0037s/iter; left time: 31.7162s
Epoch: 4 cost time: 5.891561985015869
Epoch: 4, Steps: 1422 | Train Loss: 0.6135607 Vali Loss: 0.4839437 Test Loss: 0.6454042
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.6658434
	speed: 0.0599s/iter; left time: 504.9853s
	iters: 200, epoch: 5 | loss: 0.6830935
	speed: 0.0035s/iter; left time: 28.7804s
	iters: 300, epoch: 5 | loss: 0.5926622
	speed: 0.0032s/iter; left time: 26.2967s
	iters: 400, epoch: 5 | loss: 0.6616263
	speed: 0.0041s/iter; left time: 33.0778s
	iters: 500, epoch: 5 | loss: 0.6565900
	speed: 0.0031s/iter; left time: 25.2932s
	iters: 600, epoch: 5 | loss: 0.6341516
	speed: 0.0032s/iter; left time: 25.7778s
	iters: 700, epoch: 5 | loss: 0.6316102
	speed: 0.0035s/iter; left time: 27.2898s
	iters: 800, epoch: 5 | loss: 0.8502394
	speed: 0.0033s/iter; left time: 25.3144s
	iters: 900, epoch: 5 | loss: 0.6116323
	speed: 0.0036s/iter; left time: 27.5517s
	iters: 1000, epoch: 5 | loss: 0.6192579
	speed: 0.0040s/iter; left time: 30.1677s
	iters: 1100, epoch: 5 | loss: 0.5833435
	speed: 0.0033s/iter; left time: 24.5708s
	iters: 1200, epoch: 5 | loss: 0.5534993
	speed: 0.0042s/iter; left time: 30.5426s
	iters: 1300, epoch: 5 | loss: 0.5522582
	speed: 0.0031s/iter; left time: 22.4254s
	iters: 1400, epoch: 5 | loss: 0.6491549
	speed: 0.0032s/iter; left time: 22.4717s
Epoch: 5 cost time: 6.381115674972534
Epoch: 5, Steps: 1422 | Train Loss: 0.6125586 Vali Loss: 0.4752919 Test Loss: 0.6438498
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.6490725
	speed: 0.0581s/iter; left time: 407.0342s
	iters: 200, epoch: 6 | loss: 0.6356946
	speed: 0.0034s/iter; left time: 23.1887s
	iters: 300, epoch: 6 | loss: 0.6142353
	speed: 0.0039s/iter; left time: 26.8502s
	iters: 400, epoch: 6 | loss: 0.5471532
	speed: 0.0032s/iter; left time: 21.1712s
	iters: 500, epoch: 6 | loss: 0.4997360
	speed: 0.0033s/iter; left time: 21.7279s
	iters: 600, epoch: 6 | loss: 0.5213332
	speed: 0.0043s/iter; left time: 28.2586s
	iters: 700, epoch: 6 | loss: 0.7625002
	speed: 0.0032s/iter; left time: 20.3368s
	iters: 800, epoch: 6 | loss: 0.5960070
	speed: 0.0032s/iter; left time: 20.3652s
	iters: 900, epoch: 6 | loss: 0.5466781
	speed: 0.0042s/iter; left time: 25.9545s
	iters: 1000, epoch: 6 | loss: 0.7220456
	speed: 0.0032s/iter; left time: 19.7328s
	iters: 1100, epoch: 6 | loss: 0.8115879
	speed: 0.0033s/iter; left time: 19.8770s
	iters: 1200, epoch: 6 | loss: 0.7345355
	speed: 0.0039s/iter; left time: 22.7784s
	iters: 1300, epoch: 6 | loss: 0.9629399
	speed: 0.0033s/iter; left time: 19.3167s
	iters: 1400, epoch: 6 | loss: 0.5377263
	speed: 0.0040s/iter; left time: 23.0965s
Epoch: 6 cost time: 6.400585651397705
Epoch: 6, Steps: 1422 | Train Loss: 0.6120182 Vali Loss: 0.4789288 Test Loss: 0.6440856
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exchange_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2765
mse:0.6455984115600586, mae:0.5907173156738281
INFO: Trainable parameter count: 0.07M
INFO: Trainable parameter count: 0.07M
INFO: Trainable parameter count: 0.14M
INFO: Trainable parameter count: 0.14M
