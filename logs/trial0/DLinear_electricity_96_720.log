Args in experiment:
Namespace(is_training=1, model_id='Exchange_96_720', model='DLinear', data='custom', root_path='./dataset/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=8, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=True)
Use GPU: cuda:0
>>>>>>>start training : Exchange_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.2989478
	speed: 0.0548s/iter; left time: 1200.6860s
	iters: 200, epoch: 1 | loss: 0.2917872
	speed: 0.0201s/iter; left time: 438.8804s
	iters: 300, epoch: 1 | loss: 0.2914367
	speed: 0.0190s/iter; left time: 412.3724s
	iters: 400, epoch: 1 | loss: 0.3104844
	speed: 0.0197s/iter; left time: 425.9491s
	iters: 500, epoch: 1 | loss: 0.2392108
	speed: 0.0193s/iter; left time: 415.1109s
	iters: 600, epoch: 1 | loss: 0.2850602
	speed: 0.0196s/iter; left time: 420.2329s
	iters: 700, epoch: 1 | loss: 0.2582711
	speed: 0.0198s/iter; left time: 420.6777s
	iters: 800, epoch: 1 | loss: 0.2984074
	speed: 0.0196s/iter; left time: 415.3742s
	iters: 900, epoch: 1 | loss: 0.2971874
	speed: 0.0193s/iter; left time: 407.8447s
	iters: 1000, epoch: 1 | loss: 0.2470955
	speed: 0.0194s/iter; left time: 406.8909s
	iters: 1100, epoch: 1 | loss: 0.2329073
	speed: 0.0201s/iter; left time: 419.3415s
	iters: 1200, epoch: 1 | loss: 0.2266225
	speed: 0.0193s/iter; left time: 401.2073s
	iters: 1300, epoch: 1 | loss: 0.2537285
	speed: 0.0197s/iter; left time: 407.5130s
	iters: 1400, epoch: 1 | loss: 0.2469190
	speed: 0.0194s/iter; left time: 398.6687s
	iters: 1500, epoch: 1 | loss: 0.2616453
	speed: 0.0197s/iter; left time: 403.1247s
	iters: 1600, epoch: 1 | loss: 0.2940092
	speed: 0.0195s/iter; left time: 397.0071s
	iters: 1700, epoch: 1 | loss: 0.2274569
	speed: 0.0195s/iter; left time: 394.9703s
	iters: 1800, epoch: 1 | loss: 0.2714649
	speed: 0.0192s/iter; left time: 386.6952s
	iters: 1900, epoch: 1 | loss: 0.1977375
	speed: 0.0201s/iter; left time: 404.3623s
	iters: 2000, epoch: 1 | loss: 0.2830854
	speed: 0.0196s/iter; left time: 392.1367s
	iters: 2100, epoch: 1 | loss: 0.3204520
	speed: 0.0199s/iter; left time: 395.6350s
Epoch: 1 cost time: 46.435460567474365
Epoch: 1, Steps: 2199 | Train Loss: 0.2811541 Vali Loss: 0.2148127 Test Loss: 0.2463417
Validation loss decreased (inf --> 0.214813).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2653477
	speed: 0.2678s/iter; left time: 5274.2435s
	iters: 200, epoch: 2 | loss: 0.2309985
	speed: 0.0197s/iter; left time: 386.6561s
	iters: 300, epoch: 2 | loss: 0.2090127
	speed: 0.0195s/iter; left time: 380.0255s
	iters: 400, epoch: 2 | loss: 0.2306700
	speed: 0.0198s/iter; left time: 383.5712s
	iters: 500, epoch: 2 | loss: 0.2616968
	speed: 0.0205s/iter; left time: 395.8670s
	iters: 600, epoch: 2 | loss: 0.2265860
	speed: 0.0193s/iter; left time: 370.3753s
	iters: 700, epoch: 2 | loss: 0.2567902
	speed: 0.0191s/iter; left time: 364.6994s
	iters: 800, epoch: 2 | loss: 0.3185801
	speed: 0.0202s/iter; left time: 383.2739s
	iters: 900, epoch: 2 | loss: 0.1985948
	speed: 0.0200s/iter; left time: 377.1062s
	iters: 1000, epoch: 2 | loss: 0.3267272
	speed: 0.0194s/iter; left time: 365.4454s
	iters: 1100, epoch: 2 | loss: 0.2300265
	speed: 0.0197s/iter; left time: 367.6974s
	iters: 1200, epoch: 2 | loss: 0.2262228
	speed: 0.0193s/iter; left time: 358.9394s
	iters: 1300, epoch: 2 | loss: 0.2870913
	speed: 0.0197s/iter; left time: 364.3772s
	iters: 1400, epoch: 2 | loss: 0.2360261
	speed: 0.0195s/iter; left time: 359.5483s
	iters: 1500, epoch: 2 | loss: 0.2162029
	speed: 0.0200s/iter; left time: 365.1059s
	iters: 1600, epoch: 2 | loss: 0.2226605
	speed: 0.0195s/iter; left time: 355.0358s
	iters: 1700, epoch: 2 | loss: 0.2572481
	speed: 0.0195s/iter; left time: 352.5096s
	iters: 1800, epoch: 2 | loss: 0.2411140
	speed: 0.0201s/iter; left time: 361.9715s
	iters: 1900, epoch: 2 | loss: 0.2298577
	speed: 0.0201s/iter; left time: 359.5181s
	iters: 2000, epoch: 2 | loss: 0.2168352
	speed: 0.0189s/iter; left time: 335.7670s
	iters: 2100, epoch: 2 | loss: 0.2620954
	speed: 0.0206s/iter; left time: 364.1003s
Epoch: 2 cost time: 45.21659207344055
Epoch: 2, Steps: 2199 | Train Loss: 0.2539453 Vali Loss: 0.2137524 Test Loss: 0.2432954
Validation loss decreased (0.214813 --> 0.213752).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.2240460
	speed: 0.2713s/iter; left time: 4745.3334s
	iters: 200, epoch: 3 | loss: 0.2362830
	speed: 0.0196s/iter; left time: 341.2315s
	iters: 300, epoch: 3 | loss: 0.3057876
	speed: 0.0191s/iter; left time: 330.0359s
	iters: 400, epoch: 3 | loss: 0.2525616
	speed: 0.0195s/iter; left time: 335.8341s
	iters: 500, epoch: 3 | loss: 0.2402821
	speed: 0.0192s/iter; left time: 328.8423s
	iters: 600, epoch: 3 | loss: 0.2274417
	speed: 0.0193s/iter; left time: 328.5452s
	iters: 700, epoch: 3 | loss: 0.2521234
	speed: 0.0201s/iter; left time: 339.4934s
	iters: 800, epoch: 3 | loss: 0.2173845
	speed: 0.0195s/iter; left time: 326.7854s
	iters: 900, epoch: 3 | loss: 0.2401950
	speed: 0.0202s/iter; left time: 336.4997s
	iters: 1000, epoch: 3 | loss: 0.1951558
	speed: 0.0188s/iter; left time: 312.7586s
	iters: 1100, epoch: 3 | loss: 0.2200811
	speed: 0.0192s/iter; left time: 317.1669s
	iters: 1200, epoch: 3 | loss: 0.2463758
	speed: 0.0193s/iter; left time: 317.0214s
	iters: 1300, epoch: 3 | loss: 0.2839168
	speed: 0.0194s/iter; left time: 316.3077s
	iters: 1400, epoch: 3 | loss: 0.2571158
	speed: 0.0201s/iter; left time: 325.5779s
	iters: 1500, epoch: 3 | loss: 0.2646806
	speed: 0.0193s/iter; left time: 310.3000s
	iters: 1600, epoch: 3 | loss: 0.2845016
	speed: 0.0198s/iter; left time: 315.9066s
	iters: 1700, epoch: 3 | loss: 0.2777126
	speed: 0.0183s/iter; left time: 291.2012s
	iters: 1800, epoch: 3 | loss: 0.2252625
	speed: 0.0191s/iter; left time: 302.0859s
	iters: 1900, epoch: 3 | loss: 0.2526953
	speed: 0.0195s/iter; left time: 305.2983s
	iters: 2000, epoch: 3 | loss: 0.2856677
	speed: 0.0195s/iter; left time: 303.6780s
	iters: 2100, epoch: 3 | loss: 0.3215170
	speed: 0.0194s/iter; left time: 300.1870s
Epoch: 3 cost time: 44.265721559524536
Epoch: 3, Steps: 2199 | Train Loss: 0.2520618 Vali Loss: 0.2122510 Test Loss: 0.2434389
Validation loss decreased (0.213752 --> 0.212251).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.2085310
	speed: 0.2750s/iter; left time: 4205.1715s
	iters: 200, epoch: 4 | loss: 0.2583350
	speed: 0.0195s/iter; left time: 296.9288s
	iters: 300, epoch: 4 | loss: 0.2131426
	speed: 0.0197s/iter; left time: 297.7598s
	iters: 400, epoch: 4 | loss: 0.2971572
	speed: 0.0196s/iter; left time: 293.8889s
	iters: 500, epoch: 4 | loss: 0.2608044
	speed: 0.0196s/iter; left time: 291.3660s
	iters: 600, epoch: 4 | loss: 0.1925408
	speed: 0.0195s/iter; left time: 289.2082s
	iters: 700, epoch: 4 | loss: 0.2027598
	speed: 0.0199s/iter; left time: 292.3144s
	iters: 800, epoch: 4 | loss: 0.2444969
	speed: 0.0199s/iter; left time: 289.9817s
	iters: 900, epoch: 4 | loss: 0.2483994
	speed: 0.0197s/iter; left time: 285.7982s
	iters: 1000, epoch: 4 | loss: 0.2792347
	speed: 0.0198s/iter; left time: 285.6857s
	iters: 1100, epoch: 4 | loss: 0.2389827
	speed: 0.0195s/iter; left time: 278.3090s
	iters: 1200, epoch: 4 | loss: 0.2930812
	speed: 0.0198s/iter; left time: 280.9285s
	iters: 1300, epoch: 4 | loss: 0.2333129
	speed: 0.0199s/iter; left time: 281.0418s
	iters: 1400, epoch: 4 | loss: 0.2268477
	speed: 0.0199s/iter; left time: 278.9777s
	iters: 1500, epoch: 4 | loss: 0.2473093
	speed: 0.0194s/iter; left time: 269.5558s
	iters: 1600, epoch: 4 | loss: 0.2341274
	speed: 0.0197s/iter; left time: 272.3584s
	iters: 1700, epoch: 4 | loss: 0.2609923
	speed: 0.0200s/iter; left time: 273.2915s
	iters: 1800, epoch: 4 | loss: 0.2841681
	speed: 0.0193s/iter; left time: 262.8296s
	iters: 1900, epoch: 4 | loss: 0.2626356
	speed: 0.0201s/iter; left time: 270.9504s
	iters: 2000, epoch: 4 | loss: 0.2410887
	speed: 0.0200s/iter; left time: 268.1388s
	iters: 2100, epoch: 4 | loss: 0.2197402
	speed: 0.0197s/iter; left time: 261.6865s
Epoch: 4 cost time: 44.92270255088806
Epoch: 4, Steps: 2199 | Train Loss: 0.2513672 Vali Loss: 0.2114473 Test Loss: 0.2425468
Validation loss decreased (0.212251 --> 0.211447).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.2777892
	speed: 0.2811s/iter; left time: 3681.5971s
	iters: 200, epoch: 5 | loss: 0.2099574
	speed: 0.0195s/iter; left time: 253.2814s
	iters: 300, epoch: 5 | loss: 0.1871532
	speed: 0.0190s/iter; left time: 245.1377s
	iters: 400, epoch: 5 | loss: 0.3001168
	speed: 0.0191s/iter; left time: 244.3866s
	iters: 500, epoch: 5 | loss: 0.2087654
	speed: 0.0198s/iter; left time: 250.8293s
	iters: 600, epoch: 5 | loss: 0.2047051
	speed: 0.0194s/iter; left time: 244.0797s
	iters: 700, epoch: 5 | loss: 0.2451440
	speed: 0.0195s/iter; left time: 243.1269s
	iters: 800, epoch: 5 | loss: 0.2455780
	speed: 0.0191s/iter; left time: 237.2939s
	iters: 900, epoch: 5 | loss: 0.2210301
	speed: 0.0192s/iter; left time: 236.2591s
	iters: 1000, epoch: 5 | loss: 0.2588413
	speed: 0.0202s/iter; left time: 246.6855s
	iters: 1100, epoch: 5 | loss: 0.2392336
	speed: 0.0196s/iter; left time: 237.5786s
	iters: 1200, epoch: 5 | loss: 0.2397255
	speed: 0.0195s/iter; left time: 233.7487s
	iters: 1300, epoch: 5 | loss: 0.2309140
	speed: 0.0192s/iter; left time: 228.5865s
	iters: 1400, epoch: 5 | loss: 0.2850113
	speed: 0.0199s/iter; left time: 234.7986s
	iters: 1500, epoch: 5 | loss: 0.2177066
	speed: 0.0206s/iter; left time: 241.0221s
	iters: 1600, epoch: 5 | loss: 0.2233205
	speed: 0.0196s/iter; left time: 227.0698s
	iters: 1700, epoch: 5 | loss: 0.2490967
	speed: 0.0216s/iter; left time: 248.3337s
	iters: 1800, epoch: 5 | loss: 0.2632077
	speed: 0.0196s/iter; left time: 223.3043s
	iters: 1900, epoch: 5 | loss: 0.2900220
	speed: 0.0199s/iter; left time: 224.7134s
	iters: 2000, epoch: 5 | loss: 0.2597442
	speed: 0.0189s/iter; left time: 211.4205s
	iters: 2100, epoch: 5 | loss: 0.2839646
	speed: 0.0187s/iter; left time: 207.1701s
Epoch: 5 cost time: 44.71383762359619
Epoch: 5, Steps: 2199 | Train Loss: 0.2510980 Vali Loss: 0.2121988 Test Loss: 0.2430023
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.2328186
	speed: 0.2651s/iter; left time: 2888.8970s
	iters: 200, epoch: 6 | loss: 0.3075064
	speed: 0.0194s/iter; left time: 209.0085s
	iters: 300, epoch: 6 | loss: 0.2746758
	speed: 0.0192s/iter; left time: 205.7013s
	iters: 400, epoch: 6 | loss: 0.3074574
	speed: 0.0200s/iter; left time: 212.1954s
	iters: 500, epoch: 6 | loss: 0.3003866
	speed: 0.0188s/iter; left time: 197.7116s
	iters: 600, epoch: 6 | loss: 0.2301312
	speed: 0.0195s/iter; left time: 202.2303s
	iters: 700, epoch: 6 | loss: 0.2193919
	speed: 0.0195s/iter; left time: 200.9819s
	iters: 800, epoch: 6 | loss: 0.2355527
	speed: 0.0194s/iter; left time: 198.2549s
	iters: 900, epoch: 6 | loss: 0.2442650
	speed: 0.0193s/iter; left time: 195.2795s
	iters: 1000, epoch: 6 | loss: 0.2330061
	speed: 0.0195s/iter; left time: 195.3993s
	iters: 1100, epoch: 6 | loss: 0.2360480
	speed: 0.0195s/iter; left time: 192.6446s
	iters: 1200, epoch: 6 | loss: 0.2322145
	speed: 0.0192s/iter; left time: 187.9602s
	iters: 1300, epoch: 6 | loss: 0.1881312
	speed: 0.0189s/iter; left time: 183.4230s
	iters: 1400, epoch: 6 | loss: 0.2263699
	speed: 0.0194s/iter; left time: 186.3045s
	iters: 1500, epoch: 6 | loss: 0.3031589
	speed: 0.0195s/iter; left time: 185.4713s
	iters: 1600, epoch: 6 | loss: 0.2624523
	speed: 0.0194s/iter; left time: 181.8236s
	iters: 1700, epoch: 6 | loss: 0.2970212
	speed: 0.0193s/iter; left time: 179.8223s
	iters: 1800, epoch: 6 | loss: 0.2508474
	speed: 0.0194s/iter; left time: 178.0414s
	iters: 1900, epoch: 6 | loss: 0.2343710
	speed: 0.0196s/iter; left time: 178.4618s
	iters: 2000, epoch: 6 | loss: 0.2162285
	speed: 0.0199s/iter; left time: 178.8937s
	iters: 2100, epoch: 6 | loss: 0.2250247
	speed: 0.0196s/iter; left time: 173.9658s
Epoch: 6 cost time: 44.30323600769043
Epoch: 6, Steps: 2199 | Train Loss: 0.2509158 Vali Loss: 0.2117739 Test Loss: 0.2423862
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.2072203
	speed: 0.2768s/iter; left time: 2407.1705s
	iters: 200, epoch: 7 | loss: 0.3482157
	speed: 0.0189s/iter; left time: 162.8283s
	iters: 300, epoch: 7 | loss: 0.2813700
	speed: 0.0194s/iter; left time: 164.9808s
	iters: 400, epoch: 7 | loss: 0.2770143
	speed: 0.0198s/iter; left time: 166.2888s
	iters: 500, epoch: 7 | loss: 0.2556892
	speed: 0.0197s/iter; left time: 163.5615s
	iters: 600, epoch: 7 | loss: 0.2670531
	speed: 0.0192s/iter; left time: 157.6976s
	iters: 700, epoch: 7 | loss: 0.2536132
	speed: 0.0195s/iter; left time: 157.9074s
	iters: 800, epoch: 7 | loss: 0.2483993
	speed: 0.0193s/iter; left time: 154.5953s
	iters: 900, epoch: 7 | loss: 0.2685692
	speed: 0.0197s/iter; left time: 155.9540s
	iters: 1000, epoch: 7 | loss: 0.2682492
	speed: 0.0198s/iter; left time: 154.6696s
	iters: 1100, epoch: 7 | loss: 0.2733801
	speed: 0.0192s/iter; left time: 148.1071s
	iters: 1200, epoch: 7 | loss: 0.2354497
	speed: 0.0197s/iter; left time: 149.4628s
	iters: 1300, epoch: 7 | loss: 0.2172662
	speed: 0.0191s/iter; left time: 142.9218s
	iters: 1400, epoch: 7 | loss: 0.2805431
	speed: 0.0199s/iter; left time: 147.5065s
	iters: 1500, epoch: 7 | loss: 0.2485197
	speed: 0.0194s/iter; left time: 141.7187s
	iters: 1600, epoch: 7 | loss: 0.2390378
	speed: 0.0190s/iter; left time: 136.8125s
	iters: 1700, epoch: 7 | loss: 0.2572250
	speed: 0.0190s/iter; left time: 135.1009s
	iters: 1800, epoch: 7 | loss: 0.2422557
	speed: 0.0196s/iter; left time: 137.1372s
	iters: 1900, epoch: 7 | loss: 0.2638077
	speed: 0.0196s/iter; left time: 135.1467s
	iters: 2000, epoch: 7 | loss: 0.2093857
	speed: 0.0191s/iter; left time: 129.7185s
	iters: 2100, epoch: 7 | loss: 0.2102806
	speed: 0.0193s/iter; left time: 129.2446s
Epoch: 7 cost time: 44.33732533454895
Epoch: 7, Steps: 2199 | Train Loss: 0.2508450 Vali Loss: 0.2116618 Test Loss: 0.2423697
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exchange_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
INFO: Trainable parameter count: 0.07M
INFO: Trainable parameter count: 0.07M
INFO: Trainable parameter count: 0.14M
INFO: Trainable parameter count: 0.14M
Model(
  139.68 k, 100.000% Params, 44.41 MMac, 100.000% MACs, 
  (decompsition): series_decomp(
    0, 0.000% Params, 38.52 KMac, 0.087% MACs, 
    (moving_avg): moving_avg(
      0, 0.000% Params, 38.52 KMac, 0.087% MACs, 
      (avg): AvgPool1d(0, 0.000% Params, 38.52 KMac, 0.087% MACs, kernel_size=(25,), stride=(1,), padding=(0,))
    )
  )
  (Linear_Seasonal): Linear(69.84 k, 50.000% Params, 22.19 MMac, 49.957% MACs, in_features=96, out_features=720, bias=True)
  (Linear_Trend): Linear(69.84 k, 50.000% Params, 22.19 MMac, 49.957% MACs, in_features=96, out_features=720, bias=True)
)
Computational complexity:       44.41 MMac
Number of parameters:           139.68 k
mse:0.24254730343818665, mae:0.3286983370780945
