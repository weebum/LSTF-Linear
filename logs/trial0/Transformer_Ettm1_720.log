Args in experiment:
Namespace(is_training=1, model_id='ETTm1_96_720', model='Transformer', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=4, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:4
>>>>>>>start training : ETTm1_96_720_Transformer_ETTm1_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.5410057
	speed: 0.1663s/iter; left time: 1736.2296s
	iters: 200, epoch: 1 | loss: 0.3794972
	speed: 0.1120s/iter; left time: 1158.0586s
	iters: 300, epoch: 1 | loss: 0.3635630
	speed: 0.1130s/iter; left time: 1156.9541s
	iters: 400, epoch: 1 | loss: 0.3238560
	speed: 0.1133s/iter; left time: 1148.6226s
	iters: 500, epoch: 1 | loss: 0.3096961
	speed: 0.1121s/iter; left time: 1126.0817s
	iters: 600, epoch: 1 | loss: 0.3240063
	speed: 0.1123s/iter; left time: 1116.5522s
	iters: 700, epoch: 1 | loss: 0.2632071
	speed: 0.1126s/iter; left time: 1108.2402s
	iters: 800, epoch: 1 | loss: 0.2647468
	speed: 0.1137s/iter; left time: 1107.9283s
	iters: 900, epoch: 1 | loss: 0.2843290
	speed: 0.1112s/iter; left time: 1071.8898s
	iters: 1000, epoch: 1 | loss: 0.2457514
	speed: 0.1148s/iter; left time: 1094.9034s
Epoch: 1 cost time: 124.23948073387146
Epoch: 1, Steps: 1054 | Train Loss: 0.3369831 Vali Loss: 1.2135922 Test Loss: 1.0979884
Validation loss decreased (inf --> 1.213592).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2249729
	speed: 0.5187s/iter; left time: 4869.0221s
	iters: 200, epoch: 2 | loss: 0.2138728
	speed: 0.1143s/iter; left time: 1061.3045s
	iters: 300, epoch: 2 | loss: 0.2153952
	speed: 0.1099s/iter; left time: 1009.9465s
	iters: 400, epoch: 2 | loss: 0.2114930
	speed: 0.1097s/iter; left time: 996.5582s
	iters: 500, epoch: 2 | loss: 0.1965637
	speed: 0.1099s/iter; left time: 987.7538s
	iters: 600, epoch: 2 | loss: 0.1950813
	speed: 0.1101s/iter; left time: 978.2912s
	iters: 700, epoch: 2 | loss: 0.1778995
	speed: 0.1105s/iter; left time: 971.0298s
	iters: 800, epoch: 2 | loss: 0.1799663
	speed: 0.1102s/iter; left time: 957.2515s
	iters: 900, epoch: 2 | loss: 0.1713097
	speed: 0.1097s/iter; left time: 941.9214s
	iters: 1000, epoch: 2 | loss: 0.1752659
	speed: 0.1098s/iter; left time: 931.9529s
Epoch: 2 cost time: 118.4076874256134
Epoch: 2, Steps: 1054 | Train Loss: 0.2003435 Vali Loss: 1.2920432 Test Loss: 1.1215849
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1508392
	speed: 0.4999s/iter; left time: 4165.4100s
	iters: 200, epoch: 3 | loss: 0.1531274
	speed: 0.1093s/iter; left time: 899.5480s
	iters: 300, epoch: 3 | loss: 0.1447355
	speed: 0.1101s/iter; left time: 895.6077s
	iters: 400, epoch: 3 | loss: 0.1394152
	speed: 0.1091s/iter; left time: 876.3893s
	iters: 500, epoch: 3 | loss: 0.1539239
	speed: 0.1092s/iter; left time: 865.9439s
	iters: 600, epoch: 3 | loss: 0.1366411
	speed: 0.1086s/iter; left time: 850.3368s
	iters: 700, epoch: 3 | loss: 0.1333147
	speed: 0.1069s/iter; left time: 826.7128s
	iters: 800, epoch: 3 | loss: 0.1429299
	speed: 0.1068s/iter; left time: 815.2745s
	iters: 900, epoch: 3 | loss: 0.1261020
	speed: 0.1082s/iter; left time: 815.0849s
	iters: 1000, epoch: 3 | loss: 0.1230179
	speed: 0.1072s/iter; left time: 796.9412s
Epoch: 3 cost time: 116.33578276634216
Epoch: 3, Steps: 1054 | Train Loss: 0.1439606 Vali Loss: 1.2761827 Test Loss: 1.1488987
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.1264107
	speed: 0.4659s/iter; left time: 3391.2257s
	iters: 200, epoch: 4 | loss: 0.1267625
	speed: 0.1077s/iter; left time: 773.3249s
	iters: 300, epoch: 4 | loss: 0.1207626
	speed: 0.1082s/iter; left time: 765.6764s
	iters: 400, epoch: 4 | loss: 0.1163576
	speed: 0.1074s/iter; left time: 749.5823s
	iters: 500, epoch: 4 | loss: 0.1199621
	speed: 0.1077s/iter; left time: 740.5617s
	iters: 600, epoch: 4 | loss: 0.1152885
	speed: 0.1077s/iter; left time: 730.3739s
	iters: 700, epoch: 4 | loss: 0.1170653
	speed: 0.1075s/iter; left time: 718.0561s
	iters: 800, epoch: 4 | loss: 0.1204208
	speed: 0.1075s/iter; left time: 707.1638s
	iters: 900, epoch: 4 | loss: 0.1221063
	speed: 0.1067s/iter; left time: 691.2722s
	iters: 1000, epoch: 4 | loss: 0.1146057
	speed: 0.1070s/iter; left time: 682.7473s
Epoch: 4 cost time: 114.84855651855469
Epoch: 4, Steps: 1054 | Train Loss: 0.1187593 Vali Loss: 1.2756357 Test Loss: 1.1513889
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_96_720_Transformer_ETTm1_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
mse:1.0979878902435303, mae:0.8212345242500305
