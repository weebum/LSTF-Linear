Args in experiment:
Namespace(is_training=1, model_id='ETTm2_96_96', model='Transformer', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=5, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_96_96_Transformer_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2033674
	speed: 0.1072s/iter; left time: 1141.0389s
	iters: 200, epoch: 1 | loss: 0.3699998
	speed: 0.0324s/iter; left time: 341.9586s
	iters: 300, epoch: 1 | loss: 0.1381583
	speed: 0.0320s/iter; left time: 334.2384s
	iters: 400, epoch: 1 | loss: 0.1568263
	speed: 0.0330s/iter; left time: 341.3190s
	iters: 500, epoch: 1 | loss: 0.1632996
	speed: 0.0318s/iter; left time: 325.9265s
	iters: 600, epoch: 1 | loss: 0.1542498
	speed: 0.0325s/iter; left time: 329.1986s
	iters: 700, epoch: 1 | loss: 0.2474911
	speed: 0.0331s/iter; left time: 332.8266s
	iters: 800, epoch: 1 | loss: 0.1645608
	speed: 0.0325s/iter; left time: 322.8941s
	iters: 900, epoch: 1 | loss: 0.1401369
	speed: 0.0326s/iter; left time: 320.5120s
	iters: 1000, epoch: 1 | loss: 0.1440741
	speed: 0.0329s/iter; left time: 320.6739s
Epoch: 1 cost time: 42.48590278625488
Epoch: 1, Steps: 1074 | Train Loss: 0.1802899 Vali Loss: 0.3273351 Test Loss: 0.6091813
Validation loss decreased (inf --> 0.327335).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1122382
	speed: 0.2018s/iter; left time: 1931.0057s
	iters: 200, epoch: 2 | loss: 0.1134470
	speed: 0.0330s/iter; left time: 312.5296s
	iters: 300, epoch: 2 | loss: 0.1199941
	speed: 0.0332s/iter; left time: 311.0764s
	iters: 400, epoch: 2 | loss: 0.1210656
	speed: 0.0318s/iter; left time: 294.8873s
	iters: 500, epoch: 2 | loss: 0.0822556
	speed: 0.0328s/iter; left time: 300.5857s
	iters: 600, epoch: 2 | loss: 0.1081981
	speed: 0.0321s/iter; left time: 291.1776s
	iters: 700, epoch: 2 | loss: 0.1157666
	speed: 0.0320s/iter; left time: 287.3399s
	iters: 800, epoch: 2 | loss: 0.0933153
	speed: 0.0322s/iter; left time: 285.8605s
	iters: 900, epoch: 2 | loss: 0.0862374
	speed: 0.0322s/iter; left time: 282.5494s
	iters: 1000, epoch: 2 | loss: 0.0950186
	speed: 0.0317s/iter; left time: 274.3935s
Epoch: 2 cost time: 36.598684787750244
Epoch: 2, Steps: 1074 | Train Loss: 0.1091675 Vali Loss: 0.4318095 Test Loss: 0.5741202
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.1216323
	speed: 0.1790s/iter; left time: 1519.8782s
	iters: 200, epoch: 3 | loss: 0.0756652
	speed: 0.0319s/iter; left time: 268.0495s
	iters: 300, epoch: 3 | loss: 0.0717606
	speed: 0.0309s/iter; left time: 256.4627s
	iters: 400, epoch: 3 | loss: 0.0834693
	speed: 0.0308s/iter; left time: 252.5911s
	iters: 500, epoch: 3 | loss: 0.0837354
	speed: 0.0331s/iter; left time: 267.9751s
	iters: 600, epoch: 3 | loss: 0.0673100
	speed: 0.0336s/iter; left time: 268.8626s
	iters: 700, epoch: 3 | loss: 0.1003487
	speed: 0.0329s/iter; left time: 260.0054s
	iters: 800, epoch: 3 | loss: 0.0740896
	speed: 0.0325s/iter; left time: 253.3360s
	iters: 900, epoch: 3 | loss: 0.0684741
	speed: 0.0318s/iter; left time: 244.4135s
	iters: 1000, epoch: 3 | loss: 0.0694009
	speed: 0.0323s/iter; left time: 245.4955s
Epoch: 3 cost time: 36.03220844268799
Epoch: 3, Steps: 1074 | Train Loss: 0.0739286 Vali Loss: 0.4086517 Test Loss: 0.7040535
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0618834
	speed: 0.2009s/iter; left time: 1490.1507s
	iters: 200, epoch: 4 | loss: 0.0649246
	speed: 0.0324s/iter; left time: 237.4113s
	iters: 300, epoch: 4 | loss: 0.0679472
	speed: 0.0328s/iter; left time: 236.5158s
	iters: 400, epoch: 4 | loss: 0.0621560
	speed: 0.0316s/iter; left time: 225.0760s
	iters: 500, epoch: 4 | loss: 0.0698295
	speed: 0.0321s/iter; left time: 225.5465s
	iters: 600, epoch: 4 | loss: 0.0638353
	speed: 0.0324s/iter; left time: 224.2035s
	iters: 700, epoch: 4 | loss: 0.0613469
	speed: 0.0339s/iter; left time: 231.3829s
	iters: 800, epoch: 4 | loss: 0.0692055
	speed: 0.0325s/iter; left time: 218.4012s
	iters: 900, epoch: 4 | loss: 0.0686734
	speed: 0.0324s/iter; left time: 214.5468s
	iters: 1000, epoch: 4 | loss: 0.0576938
	speed: 0.0324s/iter; left time: 210.9913s
Epoch: 4 cost time: 36.88500452041626
Epoch: 4, Steps: 1074 | Train Loss: 0.0620837 Vali Loss: 0.3854282 Test Loss: 0.6569082
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_96_96_Transformer_ETTm2_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.6091809868812561, mae:0.5794327855110168
