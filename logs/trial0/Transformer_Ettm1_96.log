Args in experiment:
Namespace(is_training=1, model_id='ETTm1_96_96', model='Transformer', data='ETTm1', root_path='./dataset/', data_path='ETTm1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=96, individual=False, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=4, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:4
>>>>>>>start training : ETTm1_96_96_Transformer_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3330262
	speed: 0.0987s/iter; left time: 1050.4936s
	iters: 200, epoch: 1 | loss: 0.2643606
	speed: 0.0317s/iter; left time: 334.5420s
	iters: 300, epoch: 1 | loss: 0.2484214
	speed: 0.0325s/iter; left time: 338.9390s
	iters: 400, epoch: 1 | loss: 0.2147208
	speed: 0.0330s/iter; left time: 340.9481s
	iters: 500, epoch: 1 | loss: 0.1963356
	speed: 0.0323s/iter; left time: 330.9711s
	iters: 600, epoch: 1 | loss: 0.2068068
	speed: 0.0341s/iter; left time: 346.2995s
	iters: 700, epoch: 1 | loss: 0.2349382
	speed: 0.0328s/iter; left time: 328.8723s
	iters: 800, epoch: 1 | loss: 0.1909184
	speed: 0.0323s/iter; left time: 320.9130s
	iters: 900, epoch: 1 | loss: 0.1571013
	speed: 0.0323s/iter; left time: 317.6810s
	iters: 1000, epoch: 1 | loss: 0.1511644
	speed: 0.0326s/iter; left time: 317.8574s
Epoch: 1 cost time: 41.752265214920044
Epoch: 1, Steps: 1074 | Train Loss: 0.2399551 Vali Loss: 0.6827593 Test Loss: 0.6288787
Validation loss decreased (inf --> 0.682759).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1934588
	speed: 0.1981s/iter; left time: 1895.1359s
	iters: 200, epoch: 2 | loss: 0.1335365
	speed: 0.0327s/iter; left time: 309.4963s
	iters: 300, epoch: 2 | loss: 0.1335419
	speed: 0.0328s/iter; left time: 307.3244s
	iters: 400, epoch: 2 | loss: 0.1411910
	speed: 0.0329s/iter; left time: 304.7932s
	iters: 500, epoch: 2 | loss: 0.1175208
	speed: 0.0316s/iter; left time: 289.6672s
	iters: 600, epoch: 2 | loss: 0.1183153
	speed: 0.0325s/iter; left time: 294.9788s
	iters: 700, epoch: 2 | loss: 0.1234745
	speed: 0.0329s/iter; left time: 294.8843s
	iters: 800, epoch: 2 | loss: 0.0960105
	speed: 0.0332s/iter; left time: 294.5698s
	iters: 900, epoch: 2 | loss: 0.1024294
	speed: 0.0329s/iter; left time: 288.4669s
	iters: 1000, epoch: 2 | loss: 0.1128940
	speed: 0.0315s/iter; left time: 272.9050s
Epoch: 2 cost time: 36.657840967178345
Epoch: 2, Steps: 1074 | Train Loss: 0.1242863 Vali Loss: 0.6864415 Test Loss: 0.5811576
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0816228
	speed: 0.1969s/iter; left time: 1672.4844s
	iters: 200, epoch: 3 | loss: 0.0786201
	speed: 0.0341s/iter; left time: 286.4027s
	iters: 300, epoch: 3 | loss: 0.0815514
	speed: 0.0318s/iter; left time: 263.7179s
	iters: 400, epoch: 3 | loss: 0.0758639
	speed: 0.0313s/iter; left time: 256.5431s
	iters: 500, epoch: 3 | loss: 0.0904949
	speed: 0.0321s/iter; left time: 259.5729s
	iters: 600, epoch: 3 | loss: 0.0760302
	speed: 0.0320s/iter; left time: 255.3947s
	iters: 700, epoch: 3 | loss: 0.0714188
	speed: 0.0322s/iter; left time: 254.4001s
	iters: 800, epoch: 3 | loss: 0.0741975
	speed: 0.0329s/iter; left time: 256.7626s
	iters: 900, epoch: 3 | loss: 0.0730382
	speed: 0.0328s/iter; left time: 252.2748s
	iters: 1000, epoch: 3 | loss: 0.0794913
	speed: 0.0325s/iter; left time: 246.5756s
Epoch: 3 cost time: 36.50786328315735
Epoch: 3, Steps: 1074 | Train Loss: 0.0803951 Vali Loss: 0.7016208 Test Loss: 0.5313928
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0729744
	speed: 0.1929s/iter; left time: 1431.2751s
	iters: 200, epoch: 4 | loss: 0.0673658
	speed: 0.0324s/iter; left time: 237.2434s
	iters: 300, epoch: 4 | loss: 0.0671300
	speed: 0.0323s/iter; left time: 233.2983s
	iters: 400, epoch: 4 | loss: 0.0717191
	speed: 0.0331s/iter; left time: 235.9292s
	iters: 500, epoch: 4 | loss: 0.0712338
	speed: 0.0320s/iter; left time: 224.2573s
	iters: 600, epoch: 4 | loss: 0.0592999
	speed: 0.0330s/iter; left time: 228.5460s
	iters: 700, epoch: 4 | loss: 0.0639588
	speed: 0.0327s/iter; left time: 222.6888s
	iters: 800, epoch: 4 | loss: 0.0614859
	speed: 0.0326s/iter; left time: 219.2614s
	iters: 900, epoch: 4 | loss: 0.0710629
	speed: 0.0330s/iter; left time: 218.6734s
	iters: 1000, epoch: 4 | loss: 0.0631762
	speed: 0.0332s/iter; left time: 216.1630s
Epoch: 4 cost time: 37.06109428405762
Epoch: 4, Steps: 1074 | Train Loss: 0.0666801 Vali Loss: 0.7161191 Test Loss: 0.5411114
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_96_96_Transformer_ETTm1_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.6288788318634033, mae:0.5755369067192078
