Args in experiment:
Namespace(is_training=1, model_id='Exchange_96_336', model='DLinear', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=8, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=True)
Use GPU: cuda:0
>>>>>>>start training : Exchange_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5119257
	speed: 0.0417s/iter; left time: 613.1019s
	iters: 200, epoch: 1 | loss: 0.4644425
	speed: 0.0212s/iter; left time: 309.3349s
	iters: 300, epoch: 1 | loss: 0.4284710
	speed: 0.0220s/iter; left time: 319.3748s
	iters: 400, epoch: 1 | loss: 0.3893619
	speed: 0.0211s/iter; left time: 303.6271s
	iters: 500, epoch: 1 | loss: 0.4200449
	speed: 0.0215s/iter; left time: 307.5137s
	iters: 600, epoch: 1 | loss: 0.3762698
	speed: 0.0212s/iter; left time: 301.5937s
	iters: 700, epoch: 1 | loss: 0.3835181
	speed: 0.0212s/iter; left time: 299.0271s
	iters: 800, epoch: 1 | loss: 0.3411166
	speed: 0.0215s/iter; left time: 301.8733s
	iters: 900, epoch: 1 | loss: 0.3822125
	speed: 0.0218s/iter; left time: 303.7788s
	iters: 1000, epoch: 1 | loss: 0.3394371
	speed: 0.0219s/iter; left time: 302.6117s
	iters: 1100, epoch: 1 | loss: 0.3651216
	speed: 0.0219s/iter; left time: 300.9173s
	iters: 1200, epoch: 1 | loss: 0.3594417
	speed: 0.0217s/iter; left time: 295.2370s
	iters: 1300, epoch: 1 | loss: 0.3832062
	speed: 0.0217s/iter; left time: 292.9586s
	iters: 1400, epoch: 1 | loss: 0.3544424
	speed: 0.0214s/iter; left time: 286.5368s
Epoch: 1 cost time: 33.754765033721924
Epoch: 1, Steps: 1481 | Train Loss: 0.4154265 Vali Loss: 0.5094754 Test Loss: 0.6203614
Validation loss decreased (inf --> 0.509475).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3619494
	speed: 0.2221s/iter; left time: 2938.3983s
	iters: 200, epoch: 2 | loss: 0.3417652
	speed: 0.0221s/iter; left time: 290.7541s
	iters: 300, epoch: 2 | loss: 0.3353122
	speed: 0.0223s/iter; left time: 290.9697s
	iters: 400, epoch: 2 | loss: 0.3688684
	speed: 0.0223s/iter; left time: 288.1311s
	iters: 500, epoch: 2 | loss: 0.3392174
	speed: 0.0218s/iter; left time: 279.4063s
	iters: 600, epoch: 2 | loss: 0.3436805
	speed: 0.0222s/iter; left time: 283.2082s
	iters: 700, epoch: 2 | loss: 0.4076704
	speed: 0.0223s/iter; left time: 281.0916s
	iters: 800, epoch: 2 | loss: 0.3654530
	speed: 0.0226s/iter; left time: 282.8690s
	iters: 900, epoch: 2 | loss: 0.3618439
	speed: 0.0275s/iter; left time: 341.3509s
	iters: 1000, epoch: 2 | loss: 0.3631473
	speed: 0.0282s/iter; left time: 347.1920s
	iters: 1100, epoch: 2 | loss: 0.3721303
	speed: 0.0258s/iter; left time: 315.1601s
	iters: 1200, epoch: 2 | loss: 0.3606338
	speed: 0.0280s/iter; left time: 339.6114s
	iters: 1300, epoch: 2 | loss: 0.3630143
	speed: 0.0268s/iter; left time: 322.9524s
	iters: 1400, epoch: 2 | loss: 0.3449848
	speed: 0.0270s/iter; left time: 322.0826s
Epoch: 2 cost time: 37.829665422439575
Epoch: 2, Steps: 1481 | Train Loss: 0.3647571 Vali Loss: 0.5023261 Test Loss: 0.6114450
Validation loss decreased (0.509475 --> 0.502326).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3885235
	speed: 0.2747s/iter; left time: 3227.7874s
	iters: 200, epoch: 3 | loss: 0.3587813
	speed: 0.0219s/iter; left time: 254.8655s
	iters: 300, epoch: 3 | loss: 0.3417814
	speed: 0.0220s/iter; left time: 254.1983s
	iters: 400, epoch: 3 | loss: 0.3667623
	speed: 0.0218s/iter; left time: 250.0355s
	iters: 500, epoch: 3 | loss: 0.3783550
	speed: 0.0218s/iter; left time: 247.0118s
	iters: 600, epoch: 3 | loss: 0.3718159
	speed: 0.0216s/iter; left time: 242.9320s
	iters: 700, epoch: 3 | loss: 0.3787832
	speed: 0.0218s/iter; left time: 242.9778s
	iters: 800, epoch: 3 | loss: 0.3169348
	speed: 0.0221s/iter; left time: 244.1780s
	iters: 900, epoch: 3 | loss: 0.3510102
	speed: 0.0217s/iter; left time: 237.6714s
	iters: 1000, epoch: 3 | loss: 0.3376032
	speed: 0.0220s/iter; left time: 238.3844s
	iters: 1100, epoch: 3 | loss: 0.3143937
	speed: 0.0219s/iter; left time: 235.4792s
	iters: 1200, epoch: 3 | loss: 0.3496052
	speed: 0.0227s/iter; left time: 241.8797s
	iters: 1300, epoch: 3 | loss: 0.3347019
	speed: 0.0223s/iter; left time: 235.1629s
	iters: 1400, epoch: 3 | loss: 0.3265867
	speed: 0.0221s/iter; left time: 230.5329s
Epoch: 3 cost time: 34.62189602851868
Epoch: 3, Steps: 1481 | Train Loss: 0.3613145 Vali Loss: 0.5003502 Test Loss: 0.6085103
Validation loss decreased (0.502326 --> 0.500350).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.3937136
	speed: 0.2337s/iter; left time: 2399.5354s
	iters: 200, epoch: 4 | loss: 0.3909223
	speed: 0.0224s/iter; left time: 227.4152s
	iters: 300, epoch: 4 | loss: 0.3378781
	speed: 0.0221s/iter; left time: 222.5460s
	iters: 400, epoch: 4 | loss: 0.3355117
	speed: 0.0227s/iter; left time: 226.7022s
	iters: 500, epoch: 4 | loss: 0.3238913
	speed: 0.0223s/iter; left time: 220.4633s
	iters: 600, epoch: 4 | loss: 0.3647964
	speed: 0.0231s/iter; left time: 225.4792s
	iters: 700, epoch: 4 | loss: 0.3830493
	speed: 0.0227s/iter; left time: 219.2271s
	iters: 800, epoch: 4 | loss: 0.3837785
	speed: 0.0227s/iter; left time: 217.5959s
	iters: 900, epoch: 4 | loss: 0.3575568
	speed: 0.0225s/iter; left time: 212.8360s
	iters: 1000, epoch: 4 | loss: 0.3807864
	speed: 0.0233s/iter; left time: 217.9544s
	iters: 1100, epoch: 4 | loss: 0.3423293
	speed: 0.0230s/iter; left time: 213.2256s
	iters: 1200, epoch: 4 | loss: 0.4120240
	speed: 0.0229s/iter; left time: 209.6363s
	iters: 1300, epoch: 4 | loss: 0.3662154
	speed: 0.0229s/iter; left time: 207.3014s
	iters: 1400, epoch: 4 | loss: 0.3764455
	speed: 0.0228s/iter; left time: 204.1093s
Epoch: 4 cost time: 35.07480835914612
Epoch: 4, Steps: 1481 | Train Loss: 0.3601776 Vali Loss: 0.4993375 Test Loss: 0.6078063
Validation loss decreased (0.500350 --> 0.499337).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.3660875
	speed: 0.2369s/iter; left time: 2081.6733s
	iters: 200, epoch: 5 | loss: 0.3723921
	speed: 0.0229s/iter; left time: 198.8540s
	iters: 300, epoch: 5 | loss: 0.3435879
	speed: 0.0228s/iter; left time: 195.9638s
	iters: 400, epoch: 5 | loss: 0.3363553
	speed: 0.0226s/iter; left time: 192.2286s
	iters: 500, epoch: 5 | loss: 0.3698599
	speed: 0.0226s/iter; left time: 189.9325s
	iters: 600, epoch: 5 | loss: 0.3140602
	speed: 0.0233s/iter; left time: 193.4038s
	iters: 700, epoch: 5 | loss: 0.3892076
	speed: 0.0227s/iter; left time: 185.5960s
	iters: 800, epoch: 5 | loss: 0.3688574
	speed: 0.0230s/iter; left time: 186.2306s
	iters: 900, epoch: 5 | loss: 0.3839783
	speed: 0.0274s/iter; left time: 218.8938s
	iters: 1000, epoch: 5 | loss: 0.3722501
	speed: 0.0271s/iter; left time: 213.4083s
	iters: 1100, epoch: 5 | loss: 0.4030512
	speed: 0.0270s/iter; left time: 210.3826s
	iters: 1200, epoch: 5 | loss: 0.3653185
	speed: 0.0278s/iter; left time: 213.8926s
	iters: 1300, epoch: 5 | loss: 0.3513928
	speed: 0.0273s/iter; left time: 206.8922s
	iters: 1400, epoch: 5 | loss: 0.4125808
	speed: 0.0278s/iter; left time: 208.4505s
Epoch: 5 cost time: 38.43063497543335
Epoch: 5, Steps: 1481 | Train Loss: 0.3596862 Vali Loss: 0.4984320 Test Loss: 0.6064702
Validation loss decreased (0.499337 --> 0.498432).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.3316634
	speed: 0.2663s/iter; left time: 1945.3564s
	iters: 200, epoch: 6 | loss: 0.3774844
	speed: 0.0230s/iter; left time: 165.6767s
	iters: 300, epoch: 6 | loss: 0.3688305
	speed: 0.0235s/iter; left time: 166.9626s
	iters: 400, epoch: 6 | loss: 0.3440023
	speed: 0.0231s/iter; left time: 161.5796s
	iters: 500, epoch: 6 | loss: 0.3315903
	speed: 0.0228s/iter; left time: 157.2818s
	iters: 600, epoch: 6 | loss: 0.3693020
	speed: 0.0222s/iter; left time: 150.8105s
	iters: 700, epoch: 6 | loss: 0.3219385
	speed: 0.0228s/iter; left time: 152.9048s
	iters: 800, epoch: 6 | loss: 0.4136425
	speed: 0.0225s/iter; left time: 148.6612s
	iters: 900, epoch: 6 | loss: 0.3348281
	speed: 0.0232s/iter; left time: 150.9737s
	iters: 1000, epoch: 6 | loss: 0.3259808
	speed: 0.0227s/iter; left time: 145.6096s
	iters: 1100, epoch: 6 | loss: 0.3412811
	speed: 0.0228s/iter; left time: 143.8264s
	iters: 1200, epoch: 6 | loss: 0.3549904
	speed: 0.0235s/iter; left time: 146.0348s
	iters: 1300, epoch: 6 | loss: 0.3756290
	speed: 0.0231s/iter; left time: 141.2917s
	iters: 1400, epoch: 6 | loss: 0.3501777
	speed: 0.0232s/iter; left time: 139.4361s
Epoch: 6 cost time: 35.575448513031006
Epoch: 6, Steps: 1481 | Train Loss: 0.3594423 Vali Loss: 0.4981624 Test Loss: 0.6062611
Validation loss decreased (0.498432 --> 0.498162).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.3164475
	speed: 0.2669s/iter; left time: 1554.8610s
	iters: 200, epoch: 7 | loss: 0.3154612
	speed: 0.0232s/iter; left time: 133.0653s
	iters: 300, epoch: 7 | loss: 0.3632207
	speed: 0.0274s/iter; left time: 154.2377s
	iters: 400, epoch: 7 | loss: 0.3599836
	speed: 0.0280s/iter; left time: 154.5763s
	iters: 500, epoch: 7 | loss: 0.3829140
	speed: 0.0244s/iter; left time: 132.3679s
	iters: 600, epoch: 7 | loss: 0.3489231
	speed: 0.0274s/iter; left time: 146.0239s
	iters: 700, epoch: 7 | loss: 0.3664745
	speed: 0.0274s/iter; left time: 142.9946s
	iters: 800, epoch: 7 | loss: 0.3455243
	speed: 0.0270s/iter; left time: 138.3955s
	iters: 900, epoch: 7 | loss: 0.3500367
	speed: 0.0278s/iter; left time: 139.6575s
	iters: 1000, epoch: 7 | loss: 0.4077081
	speed: 0.0276s/iter; left time: 135.8241s
	iters: 1100, epoch: 7 | loss: 0.3423578
	speed: 0.0267s/iter; left time: 128.6105s
	iters: 1200, epoch: 7 | loss: 0.3881764
	speed: 0.0268s/iter; left time: 126.8393s
	iters: 1300, epoch: 7 | loss: 0.3652124
	speed: 0.0274s/iter; left time: 126.6759s
	iters: 1400, epoch: 7 | loss: 0.3562724
	speed: 0.0278s/iter; left time: 125.8499s
Epoch: 7 cost time: 40.77258515357971
Epoch: 7, Steps: 1481 | Train Loss: 0.3593062 Vali Loss: 0.4978915 Test Loss: 0.6061319
Validation loss decreased (0.498162 --> 0.497892).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.3561802
	speed: 0.2686s/iter; left time: 1166.7409s
	iters: 200, epoch: 8 | loss: 0.3708492
	speed: 0.0227s/iter; left time: 96.2229s
	iters: 300, epoch: 8 | loss: 0.3337052
	speed: 0.0222s/iter; left time: 92.1950s
	iters: 400, epoch: 8 | loss: 0.3912227
	speed: 0.0222s/iter; left time: 89.7175s
	iters: 500, epoch: 8 | loss: 0.3271723
	speed: 0.0217s/iter; left time: 85.6363s
	iters: 600, epoch: 8 | loss: 0.3721166
	speed: 0.0221s/iter; left time: 84.8673s
	iters: 700, epoch: 8 | loss: 0.3395350
	speed: 0.0223s/iter; left time: 83.3517s
	iters: 800, epoch: 8 | loss: 0.3386448
	speed: 0.0220s/iter; left time: 80.1746s
	iters: 900, epoch: 8 | loss: 0.3847641
	speed: 0.0222s/iter; left time: 78.5284s
	iters: 1000, epoch: 8 | loss: 0.3745297
	speed: 0.0221s/iter; left time: 76.2476s
	iters: 1100, epoch: 8 | loss: 0.3071280
	speed: 0.0221s/iter; left time: 73.8447s
	iters: 1200, epoch: 8 | loss: 0.3560931
	speed: 0.0225s/iter; left time: 72.9213s
	iters: 1300, epoch: 8 | loss: 0.3576477
	speed: 0.0218s/iter; left time: 68.4643s
	iters: 1400, epoch: 8 | loss: 0.3432983
	speed: 0.0222s/iter; left time: 67.5135s
Epoch: 8 cost time: 34.24228119850159
Epoch: 8, Steps: 1481 | Train Loss: 0.3592303 Vali Loss: 0.4978077 Test Loss: 0.6060056
Validation loss decreased (0.497892 --> 0.497808).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.3543988
	speed: 0.2456s/iter; left time: 703.1003s
	iters: 200, epoch: 9 | loss: 0.3547792
	speed: 0.0225s/iter; left time: 62.2151s
	iters: 300, epoch: 9 | loss: 0.3553578
	speed: 0.0224s/iter; left time: 59.5309s
	iters: 400, epoch: 9 | loss: 0.3505162
	speed: 0.0223s/iter; left time: 57.1930s
	iters: 500, epoch: 9 | loss: 0.3965646
	speed: 0.0226s/iter; left time: 55.5469s
	iters: 600, epoch: 9 | loss: 0.3871998
	speed: 0.0226s/iter; left time: 53.4254s
	iters: 700, epoch: 9 | loss: 0.3987596
	speed: 0.0224s/iter; left time: 50.6135s
	iters: 800, epoch: 9 | loss: 0.3545001
	speed: 0.0224s/iter; left time: 48.4151s
	iters: 900, epoch: 9 | loss: 0.3479052
	speed: 0.0230s/iter; left time: 47.3586s
	iters: 1000, epoch: 9 | loss: 0.3689880
	speed: 0.0225s/iter; left time: 44.1818s
	iters: 1100, epoch: 9 | loss: 0.3458697
	speed: 0.0225s/iter; left time: 42.0067s
	iters: 1200, epoch: 9 | loss: 0.3550114
	speed: 0.0227s/iter; left time: 40.0300s
	iters: 1300, epoch: 9 | loss: 0.3573775
	speed: 0.0222s/iter; left time: 36.9204s
	iters: 1400, epoch: 9 | loss: 0.3435129
	speed: 0.0228s/iter; left time: 35.5831s
Epoch: 9 cost time: 34.89431619644165
Epoch: 9, Steps: 1481 | Train Loss: 0.3592017 Vali Loss: 0.4979748 Test Loss: 0.6060459
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.3602441
	speed: 0.2482s/iter; left time: 343.0174s
	iters: 200, epoch: 10 | loss: 0.3574112
	speed: 0.0229s/iter; left time: 29.3511s
	iters: 300, epoch: 10 | loss: 0.3817098
	speed: 0.0222s/iter; left time: 26.2150s
	iters: 400, epoch: 10 | loss: 0.3817510
	speed: 0.0227s/iter; left time: 24.5664s
	iters: 500, epoch: 10 | loss: 0.3509306
	speed: 0.0231s/iter; left time: 22.6890s
	iters: 600, epoch: 10 | loss: 0.3385428
	speed: 0.0232s/iter; left time: 20.5044s
	iters: 700, epoch: 10 | loss: 0.3627250
	speed: 0.0228s/iter; left time: 17.7919s
	iters: 800, epoch: 10 | loss: 0.3722052
	speed: 0.0220s/iter; left time: 15.0307s
	iters: 900, epoch: 10 | loss: 0.3516759
	speed: 0.0230s/iter; left time: 13.3843s
	iters: 1000, epoch: 10 | loss: 0.3484912
	speed: 0.0233s/iter; left time: 11.2479s
	iters: 1100, epoch: 10 | loss: 0.3502762
	speed: 0.0233s/iter; left time: 8.8865s
	iters: 1200, epoch: 10 | loss: 0.3422758
	speed: 0.0226s/iter; left time: 6.3738s
	iters: 1300, epoch: 10 | loss: 0.3552729
	speed: 0.0227s/iter; left time: 4.1395s
	iters: 1400, epoch: 10 | loss: 0.3310043
	speed: 0.0230s/iter; left time: 1.8870s
Epoch: 10 cost time: 35.29452657699585
Epoch: 10, Steps: 1481 | Train Loss: 0.3591688 Vali Loss: 0.4978138 Test Loss: 0.6060446
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
>>>>>>>testing : Exchange_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
mse:0.6060140132904053, mae:0.3744276463985443
INFO: Trainable parameter count: 0.03M
INFO: Trainable parameter count: 0.03M
INFO: Trainable parameter count: 0.06M
INFO: Trainable parameter count: 0.07M
Model(
  65.18 k, 100.000% Params, 55.71 MMac, 100.000% MACs, 
  (decompsition): series_decomp(
    0, 0.000% Params, 103.44 KMac, 0.186% MACs, 
    (moving_avg): moving_avg(
      0, 0.000% Params, 103.44 KMac, 0.186% MACs, 
      (avg): AvgPool1d(0, 0.000% Params, 103.44 KMac, 0.186% MACs, kernel_size=(25,), stride=(1,), padding=(0,))
    )
  )
  (Linear_Seasonal): Linear(32.59 k, 50.000% Params, 27.81 MMac, 49.907% MACs, in_features=96, out_features=336, bias=True)
  (Linear_Trend): Linear(32.59 k, 50.000% Params, 27.81 MMac, 49.907% MACs, in_features=96, out_features=336, bias=True)
)
Computational complexity:       55.71 MMac
Number of parameters:           65.18 k 
