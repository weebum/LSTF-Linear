Args in experiment:
Namespace(is_training=1, model_id='ETTm2_96_336', model='Autoformer', data='ETTm2', root_path='./dataset/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=7, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=5, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_96_336_Autoformer_ETTm2_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.3534938
	speed: 0.1721s/iter; left time: 1817.1757s
	iters: 200, epoch: 1 | loss: 0.5017619
	speed: 0.1090s/iter; left time: 1139.7402s
	iters: 300, epoch: 1 | loss: 0.2913452
	speed: 0.1112s/iter; left time: 1152.4908s
	iters: 400, epoch: 1 | loss: 0.2988340
	speed: 0.1102s/iter; left time: 1130.4851s
	iters: 500, epoch: 1 | loss: 0.6245983
	speed: 0.1103s/iter; left time: 1121.1825s
	iters: 600, epoch: 1 | loss: 0.3454178
	speed: 0.1119s/iter; left time: 1125.8060s
	iters: 700, epoch: 1 | loss: 0.4905480
	speed: 0.1116s/iter; left time: 1112.0739s
	iters: 800, epoch: 1 | loss: 0.4434502
	speed: 0.1105s/iter; left time: 1089.2340s
	iters: 900, epoch: 1 | loss: 0.2117996
	speed: 0.1114s/iter; left time: 1087.3709s
	iters: 1000, epoch: 1 | loss: 0.2437032
	speed: 0.1106s/iter; left time: 1068.0577s
Epoch: 1 cost time: 124.34345579147339
Epoch: 1, Steps: 1066 | Train Loss: 0.4556975 Vali Loss: 0.2301706 Test Loss: 0.3290121
Validation loss decreased (inf --> 0.230171).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4416655
	speed: 0.8423s/iter; left time: 7997.7238s
	iters: 200, epoch: 2 | loss: 0.5192102
	speed: 0.1111s/iter; left time: 1044.2535s
	iters: 300, epoch: 2 | loss: 0.8983796
	speed: 0.1135s/iter; left time: 1054.7229s
	iters: 400, epoch: 2 | loss: 0.2884806
	speed: 0.1090s/iter; left time: 1002.0270s
	iters: 500, epoch: 2 | loss: 0.3908334
	speed: 0.1126s/iter; left time: 1023.7715s
	iters: 600, epoch: 2 | loss: 0.2600247
	speed: 0.1118s/iter; left time: 1005.5036s
	iters: 700, epoch: 2 | loss: 0.1872383
	speed: 0.1106s/iter; left time: 983.9242s
	iters: 800, epoch: 2 | loss: 0.3794786
	speed: 0.1106s/iter; left time: 973.0529s
	iters: 900, epoch: 2 | loss: 0.3258724
	speed: 0.1104s/iter; left time: 960.1311s
	iters: 1000, epoch: 2 | loss: 0.3466748
	speed: 0.1108s/iter; left time: 952.6548s
Epoch: 2 cost time: 120.10848665237427
Epoch: 2, Steps: 1066 | Train Loss: 0.4287345 Vali Loss: 0.2775495 Test Loss: 0.3985724
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3009449
	speed: 0.8602s/iter; left time: 7250.7144s
	iters: 200, epoch: 3 | loss: 0.5821139
	speed: 0.1108s/iter; left time: 923.1532s
	iters: 300, epoch: 3 | loss: 0.2714896
	speed: 0.1104s/iter; left time: 908.8121s
	iters: 400, epoch: 3 | loss: 0.2812418
	speed: 0.1109s/iter; left time: 901.2301s
	iters: 500, epoch: 3 | loss: 0.3057033
	speed: 0.1132s/iter; left time: 908.7229s
	iters: 600, epoch: 3 | loss: 0.3125274
	speed: 0.1101s/iter; left time: 873.1520s
	iters: 700, epoch: 3 | loss: 0.3262394
	speed: 0.1110s/iter; left time: 868.7561s
	iters: 800, epoch: 3 | loss: 0.3605501
	speed: 0.1106s/iter; left time: 854.5663s
	iters: 900, epoch: 3 | loss: 0.2294024
	speed: 0.1115s/iter; left time: 850.6575s
	iters: 1000, epoch: 3 | loss: 0.3847388
	speed: 0.1121s/iter; left time: 844.2165s
Epoch: 3 cost time: 120.26777219772339
Epoch: 3, Steps: 1066 | Train Loss: 0.3963083 Vali Loss: 0.3865258 Test Loss: 0.5135066
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.2894796
	speed: 0.8394s/iter; left time: 6180.5395s
	iters: 200, epoch: 4 | loss: 0.2406971
	speed: 0.1117s/iter; left time: 811.1514s
	iters: 300, epoch: 4 | loss: 0.2615199
	speed: 0.1113s/iter; left time: 796.9287s
	iters: 400, epoch: 4 | loss: 0.4636757
	speed: 0.1122s/iter; left time: 792.5018s
	iters: 500, epoch: 4 | loss: 0.5887118
	speed: 0.1129s/iter; left time: 786.1038s
	iters: 600, epoch: 4 | loss: 0.3157805
	speed: 0.1114s/iter; left time: 764.3510s
	iters: 700, epoch: 4 | loss: 0.3099991
	speed: 0.1111s/iter; left time: 751.3494s
	iters: 800, epoch: 4 | loss: 0.3927217
	speed: 0.1108s/iter; left time: 738.4186s
	iters: 900, epoch: 4 | loss: 0.2217151
	speed: 0.1119s/iter; left time: 734.3679s
	iters: 1000, epoch: 4 | loss: 0.3442264
	speed: 0.1104s/iter; left time: 713.2997s
Epoch: 4 cost time: 120.6593017578125
Epoch: 4, Steps: 1066 | Train Loss: 0.3788864 Vali Loss: 0.3385915 Test Loss: 0.4929521
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_96_336_Autoformer_ETTm2_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.3290118873119354, mae:0.3637596666812897
