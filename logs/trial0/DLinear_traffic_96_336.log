Args in experiment:
Namespace(is_training=1, model_id='Exchange_96_336', model='DLinear', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=336, individual=False, embed_type=0, enc_in=8, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=True)
Use GPU: cuda:0
>>>>>>>start training : Exchange_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11849
val 1421
test 3173
	iters: 100, epoch: 1 | loss: 0.5119257
	speed: 0.0469s/iter; left time: 690.2388s
	iters: 200, epoch: 1 | loss: 0.4644425
	speed: 0.0227s/iter; left time: 332.3037s
	iters: 300, epoch: 1 | loss: 0.4284710
	speed: 0.0230s/iter; left time: 333.1631s
	iters: 400, epoch: 1 | loss: 0.3893619
	speed: 0.0226s/iter; left time: 326.2378s
	iters: 500, epoch: 1 | loss: 0.4200449
	speed: 0.0236s/iter; left time: 337.2019s
	iters: 600, epoch: 1 | loss: 0.3762698
	speed: 0.0231s/iter; left time: 327.9745s
	iters: 700, epoch: 1 | loss: 0.3835181
	speed: 0.0236s/iter; left time: 332.4467s
	iters: 800, epoch: 1 | loss: 0.3411166
	speed: 0.0228s/iter; left time: 319.8008s
	iters: 900, epoch: 1 | loss: 0.3822125
	speed: 0.0230s/iter; left time: 320.4811s
	iters: 1000, epoch: 1 | loss: 0.3394371
	speed: 0.0227s/iter; left time: 314.0712s
	iters: 1100, epoch: 1 | loss: 0.3651216
	speed: 0.0230s/iter; left time: 315.8918s
	iters: 1200, epoch: 1 | loss: 0.3594417
	speed: 0.0224s/iter; left time: 304.6713s
	iters: 1300, epoch: 1 | loss: 0.3832062
	speed: 0.0233s/iter; left time: 314.3573s
	iters: 1400, epoch: 1 | loss: 0.3544424
	speed: 0.0220s/iter; left time: 294.6359s
Epoch: 1 cost time: 36.07213377952576
Epoch: 1, Steps: 1481 | Train Loss: 0.4154265 Vali Loss: 0.5094754 Test Loss: 0.6203614
Validation loss decreased (inf --> 0.509475).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3619494
	speed: 0.2449s/iter; left time: 3239.5654s
	iters: 200, epoch: 2 | loss: 0.3417652
	speed: 0.0228s/iter; left time: 299.8879s
	iters: 300, epoch: 2 | loss: 0.3353122
	speed: 0.0227s/iter; left time: 295.4752s
	iters: 400, epoch: 2 | loss: 0.3688684
	speed: 0.0226s/iter; left time: 292.6494s
	iters: 500, epoch: 2 | loss: 0.3392174
	speed: 0.0221s/iter; left time: 283.7995s
	iters: 600, epoch: 2 | loss: 0.3436805
	speed: 0.0228s/iter; left time: 289.6602s
	iters: 700, epoch: 2 | loss: 0.4076704
	speed: 0.0226s/iter; left time: 285.6598s
	iters: 800, epoch: 2 | loss: 0.3654530
	speed: 0.0229s/iter; left time: 287.0642s
	iters: 900, epoch: 2 | loss: 0.3618439
	speed: 0.0226s/iter; left time: 280.4591s
	iters: 1000, epoch: 2 | loss: 0.3631473
	speed: 0.0228s/iter; left time: 281.3499s
	iters: 1100, epoch: 2 | loss: 0.3721303
	speed: 0.0228s/iter; left time: 279.4278s
	iters: 1200, epoch: 2 | loss: 0.3606338
	speed: 0.0229s/iter; left time: 278.1612s
	iters: 1300, epoch: 2 | loss: 0.3630143
	speed: 0.0236s/iter; left time: 284.3536s
	iters: 1400, epoch: 2 | loss: 0.3449848
	speed: 0.0232s/iter; left time: 276.7883s
Epoch: 2 cost time: 35.40928053855896
Epoch: 2, Steps: 1481 | Train Loss: 0.3647571 Vali Loss: 0.5023261 Test Loss: 0.6114450
Validation loss decreased (0.509475 --> 0.502326).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3885235
	speed: 0.2637s/iter; left time: 3098.3022s
	iters: 200, epoch: 3 | loss: 0.3587813
	speed: 0.0235s/iter; left time: 273.5316s
	iters: 300, epoch: 3 | loss: 0.3417814
	speed: 0.0227s/iter; left time: 261.9135s
	iters: 400, epoch: 3 | loss: 0.3667623
	speed: 0.0229s/iter; left time: 262.3263s
	iters: 500, epoch: 3 | loss: 0.3783550
	speed: 0.0226s/iter; left time: 256.9809s
	iters: 600, epoch: 3 | loss: 0.3718159
	speed: 0.0226s/iter; left time: 254.2318s
	iters: 700, epoch: 3 | loss: 0.3787832
	speed: 0.0226s/iter; left time: 252.4177s
	iters: 800, epoch: 3 | loss: 0.3169348
	speed: 0.0234s/iter; left time: 258.4072s
	iters: 900, epoch: 3 | loss: 0.3510102
	speed: 0.0232s/iter; left time: 254.2660s
	iters: 1000, epoch: 3 | loss: 0.3376032
	speed: 0.0234s/iter; left time: 254.2486s
	iters: 1100, epoch: 3 | loss: 0.3143937
	speed: 0.0230s/iter; left time: 247.3344s
	iters: 1200, epoch: 3 | loss: 0.3496052
	speed: 0.0250s/iter; left time: 266.3312s
	iters: 1300, epoch: 3 | loss: 0.3347019
	speed: 0.0276s/iter; left time: 291.1558s
	iters: 1400, epoch: 3 | loss: 0.3265867
	speed: 0.0285s/iter; left time: 297.7948s
Epoch: 3 cost time: 37.55063033103943
Epoch: 3, Steps: 1481 | Train Loss: 0.3613145 Vali Loss: 0.5003502 Test Loss: 0.6085103
Validation loss decreased (0.502326 --> 0.500350).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.3937136
	speed: 0.3457s/iter; left time: 3549.5590s
	iters: 200, epoch: 4 | loss: 0.3909223
	speed: 0.0287s/iter; left time: 292.0163s
	iters: 300, epoch: 4 | loss: 0.3378781
	speed: 0.0280s/iter; left time: 281.8919s
	iters: 400, epoch: 4 | loss: 0.3355117
	speed: 0.0285s/iter; left time: 284.3883s
	iters: 500, epoch: 4 | loss: 0.3238913
	speed: 0.0291s/iter; left time: 287.3187s
	iters: 600, epoch: 4 | loss: 0.3647964
	speed: 0.0287s/iter; left time: 279.9228s
	iters: 700, epoch: 4 | loss: 0.3830493
	speed: 0.0283s/iter; left time: 273.1541s
	iters: 800, epoch: 4 | loss: 0.3837785
	speed: 0.0280s/iter; left time: 267.5541s
	iters: 900, epoch: 4 | loss: 0.3575568
	speed: 0.0288s/iter; left time: 272.6299s
	iters: 1000, epoch: 4 | loss: 0.3807864
	speed: 0.0279s/iter; left time: 261.2814s
	iters: 1100, epoch: 4 | loss: 0.3423293
	speed: 0.0286s/iter; left time: 264.6028s
	iters: 1200, epoch: 4 | loss: 0.4120240
	speed: 0.0280s/iter; left time: 256.2858s
	iters: 1300, epoch: 4 | loss: 0.3662154
	speed: 0.0280s/iter; left time: 253.7273s
	iters: 1400, epoch: 4 | loss: 0.3764455
	speed: 0.0280s/iter; left time: 251.4383s
Epoch: 4 cost time: 44.09522819519043
Epoch: 4, Steps: 1481 | Train Loss: 0.3601776 Vali Loss: 0.4993375 Test Loss: 0.6078063
Validation loss decreased (0.500350 --> 0.499337).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.3660875
	speed: 0.3440s/iter; left time: 3023.1205s
	iters: 200, epoch: 5 | loss: 0.3723921
	speed: 0.0286s/iter; left time: 248.1456s
	iters: 300, epoch: 5 | loss: 0.3435879
	speed: 0.0281s/iter; left time: 240.9905s
	iters: 400, epoch: 5 | loss: 0.3363553
	speed: 0.0290s/iter; left time: 246.0328s
	iters: 500, epoch: 5 | loss: 0.3698599
	speed: 0.0279s/iter; left time: 233.6256s
	iters: 600, epoch: 5 | loss: 0.3140602
	speed: 0.0281s/iter; left time: 233.0688s
	iters: 700, epoch: 5 | loss: 0.3892076
	speed: 0.0286s/iter; left time: 233.8166s
	iters: 800, epoch: 5 | loss: 0.3688574
	speed: 0.0283s/iter; left time: 228.9677s
	iters: 900, epoch: 5 | loss: 0.3839783
	speed: 0.0289s/iter; left time: 230.7207s
	iters: 1000, epoch: 5 | loss: 0.3722501
	speed: 0.0277s/iter; left time: 218.5851s
	iters: 1100, epoch: 5 | loss: 0.4030512
	speed: 0.0282s/iter; left time: 219.6036s
	iters: 1200, epoch: 5 | loss: 0.3653185
	speed: 0.0280s/iter; left time: 215.5402s
	iters: 1300, epoch: 5 | loss: 0.3513928
	speed: 0.0287s/iter; left time: 217.8742s
	iters: 1400, epoch: 5 | loss: 0.4125808
	speed: 0.0295s/iter; left time: 221.0026s
Epoch: 5 cost time: 44.17767906188965
Epoch: 5, Steps: 1481 | Train Loss: 0.3596862 Vali Loss: 0.4984320 Test Loss: 0.6064702
Validation loss decreased (0.499337 --> 0.498432).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.3316634
	speed: 0.3484s/iter; left time: 2545.7720s
	iters: 200, epoch: 6 | loss: 0.3774844
	speed: 0.0288s/iter; left time: 207.7033s
	iters: 300, epoch: 6 | loss: 0.3688305
	speed: 0.0281s/iter; left time: 199.5578s
	iters: 400, epoch: 6 | loss: 0.3440023
	speed: 0.0283s/iter; left time: 198.2599s
	iters: 500, epoch: 6 | loss: 0.3315903
	speed: 0.0291s/iter; left time: 201.2431s
	iters: 600, epoch: 6 | loss: 0.3693020
	speed: 0.0277s/iter; left time: 188.4623s
	iters: 700, epoch: 6 | loss: 0.3219385
	speed: 0.0280s/iter; left time: 187.7932s
	iters: 800, epoch: 6 | loss: 0.4136425
	speed: 0.0279s/iter; left time: 184.3683s
	iters: 900, epoch: 6 | loss: 0.3348281
	speed: 0.0286s/iter; left time: 185.9005s
	iters: 1000, epoch: 6 | loss: 0.3259808
	speed: 0.0279s/iter; left time: 178.7707s
	iters: 1100, epoch: 6 | loss: 0.3412811
	speed: 0.0275s/iter; left time: 173.3174s
	iters: 1200, epoch: 6 | loss: 0.3549904
	speed: 0.0280s/iter; left time: 173.8386s
	iters: 1300, epoch: 6 | loss: 0.3756290
	speed: 0.0284s/iter; left time: 173.5879s
	iters: 1400, epoch: 6 | loss: 0.3501777
	speed: 0.0281s/iter; left time: 168.8566s
Epoch: 6 cost time: 43.94145226478577
Epoch: 6, Steps: 1481 | Train Loss: 0.3594423 Vali Loss: 0.4981624 Test Loss: 0.6062611
Validation loss decreased (0.498432 --> 0.498162).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.3164475
	speed: 0.3486s/iter; left time: 2030.4419s
	iters: 200, epoch: 7 | loss: 0.3154612
	speed: 0.0280s/iter; left time: 160.3168s
	iters: 300, epoch: 7 | loss: 0.3632207
	speed: 0.0282s/iter; left time: 158.5915s
	iters: 400, epoch: 7 | loss: 0.3599836
	speed: 0.0285s/iter; left time: 157.4835s
	iters: 500, epoch: 7 | loss: 0.3829140
	speed: 0.0285s/iter; left time: 154.7548s
	iters: 600, epoch: 7 | loss: 0.3489231
	speed: 0.0276s/iter; left time: 146.8763s
	iters: 700, epoch: 7 | loss: 0.3664745
	speed: 0.0286s/iter; left time: 149.6876s
	iters: 800, epoch: 7 | loss: 0.3455243
	speed: 0.0287s/iter; left time: 147.3322s
	iters: 900, epoch: 7 | loss: 0.3500367
	speed: 0.0288s/iter; left time: 144.8457s
	iters: 1000, epoch: 7 | loss: 0.4077081
	speed: 0.0287s/iter; left time: 141.3591s
	iters: 1100, epoch: 7 | loss: 0.3423578
	speed: 0.0281s/iter; left time: 135.3481s
	iters: 1200, epoch: 7 | loss: 0.3881764
	speed: 0.0280s/iter; left time: 132.3240s
	iters: 1300, epoch: 7 | loss: 0.3652124
	speed: 0.0274s/iter; left time: 126.5240s
	iters: 1400, epoch: 7 | loss: 0.3562724
	speed: 0.0290s/iter; left time: 131.3682s
Epoch: 7 cost time: 44.110289096832275
Epoch: 7, Steps: 1481 | Train Loss: 0.3593062 Vali Loss: 0.4978915 Test Loss: 0.6061319
Validation loss decreased (0.498162 --> 0.497892).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.3561802
	speed: 0.3566s/iter; left time: 1549.2060s
	iters: 200, epoch: 8 | loss: 0.3708492
	speed: 0.0285s/iter; left time: 120.8691s
	iters: 300, epoch: 8 | loss: 0.3337052
	speed: 0.0272s/iter; left time: 112.7869s
	iters: 400, epoch: 8 | loss: 0.3912227
	speed: 0.0285s/iter; left time: 115.1951s
	iters: 500, epoch: 8 | loss: 0.3271723
	speed: 0.0284s/iter; left time: 111.9075s
	iters: 600, epoch: 8 | loss: 0.3721166
	speed: 0.0289s/iter; left time: 111.2475s
	iters: 700, epoch: 8 | loss: 0.3395350
	speed: 0.0278s/iter; left time: 104.0903s
	iters: 800, epoch: 8 | loss: 0.3386448
	speed: 0.0290s/iter; left time: 105.7536s
	iters: 900, epoch: 8 | loss: 0.3847641
	speed: 0.0286s/iter; left time: 101.2990s
	iters: 1000, epoch: 8 | loss: 0.3745297
	speed: 0.0297s/iter; left time: 102.2979s
	iters: 1100, epoch: 8 | loss: 0.3071280
	speed: 0.0280s/iter; left time: 93.5648s
	iters: 1200, epoch: 8 | loss: 0.3560931
	speed: 0.0283s/iter; left time: 91.6603s
	iters: 1300, epoch: 8 | loss: 0.3576477
	speed: 0.0284s/iter; left time: 89.1522s
	iters: 1400, epoch: 8 | loss: 0.3432983
	speed: 0.0283s/iter; left time: 86.2638s
Epoch: 8 cost time: 44.072529792785645
Epoch: 8, Steps: 1481 | Train Loss: 0.3592303 Vali Loss: 0.4978077 Test Loss: 0.6060056
Validation loss decreased (0.497892 --> 0.497808).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.3543988
	speed: 0.3463s/iter; left time: 991.3182s
	iters: 200, epoch: 9 | loss: 0.3547792
	speed: 0.0285s/iter; left time: 78.6704s
	iters: 300, epoch: 9 | loss: 0.3553578
	speed: 0.0278s/iter; left time: 74.0009s
	iters: 400, epoch: 9 | loss: 0.3505162
	speed: 0.0281s/iter; left time: 71.9075s
	iters: 500, epoch: 9 | loss: 0.3965646
	speed: 0.0279s/iter; left time: 68.6785s
	iters: 600, epoch: 9 | loss: 0.3871998
	speed: 0.0293s/iter; left time: 69.3303s
	iters: 700, epoch: 9 | loss: 0.3987596
	speed: 0.0298s/iter; left time: 67.4555s
	iters: 800, epoch: 9 | loss: 0.3545001
	speed: 0.0287s/iter; left time: 62.1533s
	iters: 900, epoch: 9 | loss: 0.3479052
	speed: 0.0281s/iter; left time: 57.8979s
	iters: 1000, epoch: 9 | loss: 0.3689880
	speed: 0.0286s/iter; left time: 56.1370s
	iters: 1100, epoch: 9 | loss: 0.3458697
	speed: 0.0288s/iter; left time: 53.7235s
	iters: 1200, epoch: 9 | loss: 0.3550114
	speed: 0.0288s/iter; left time: 50.6888s
	iters: 1300, epoch: 9 | loss: 0.3573775
	speed: 0.0283s/iter; left time: 47.0100s
	iters: 1400, epoch: 9 | loss: 0.3435129
	speed: 0.0294s/iter; left time: 45.9260s
Epoch: 9 cost time: 44.21601676940918
Epoch: 9, Steps: 1481 | Train Loss: 0.3592017 Vali Loss: 0.4979748 Test Loss: 0.6060459
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.3602441
	speed: 0.3431s/iter; left time: 474.2177s
	iters: 200, epoch: 10 | loss: 0.3574112
	speed: 0.0283s/iter; left time: 36.2345s
	iters: 300, epoch: 10 | loss: 0.3817098
	speed: 0.0289s/iter; left time: 34.2107s
	iters: 400, epoch: 10 | loss: 0.3817510
	speed: 0.0283s/iter; left time: 30.6577s
	iters: 500, epoch: 10 | loss: 0.3509306
	speed: 0.0287s/iter; left time: 28.2322s
	iters: 600, epoch: 10 | loss: 0.3385428
	speed: 0.0283s/iter; left time: 24.9835s
	iters: 700, epoch: 10 | loss: 0.3627250
	speed: 0.0287s/iter; left time: 22.4666s
	iters: 800, epoch: 10 | loss: 0.3722052
	speed: 0.0284s/iter; left time: 19.3553s
	iters: 900, epoch: 10 | loss: 0.3516759
	speed: 0.0278s/iter; left time: 16.2077s
	iters: 1000, epoch: 10 | loss: 0.3484912
	speed: 0.0283s/iter; left time: 13.6341s
	iters: 1100, epoch: 10 | loss: 0.3502762
	speed: 0.0284s/iter; left time: 10.8679s
	iters: 1200, epoch: 10 | loss: 0.3422758
	speed: 0.0281s/iter; left time: 7.9272s
	iters: 1300, epoch: 10 | loss: 0.3552729
	speed: 0.0288s/iter; left time: 5.2460s
	iters: 1400, epoch: 10 | loss: 0.3310043
	speed: 0.0283s/iter; left time: 2.3200s
Epoch: 10 cost time: 43.89973163604736
Epoch: 10, Steps: 1481 | Train Loss: 0.3591688 Vali Loss: 0.4978138 Test Loss: 0.6060446
EarlyStopping counter: 2 out of 3
Updating learning rate to 9.765625e-07
>>>>>>>testing : Exchange_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3173
INFO: Trainable parameter count: 0.03M
INFO: Trainable parameter count: 0.03M
INFO: Trainable parameter count: 0.06M
INFO: Trainable parameter count: 0.07M
Model(
  65.18 k, 100.000% Params, 55.71 MMac, 100.000% MACs, 
  (decompsition): series_decomp(
    0, 0.000% Params, 103.44 KMac, 0.186% MACs, 
    (moving_avg): moving_avg(
      0, 0.000% Params, 103.44 KMac, 0.186% MACs, 
      (avg): AvgPool1d(0, 0.000% Params, 103.44 KMac, 0.186% MACs, kernel_size=(25,), stride=(1,), padding=(0,))
    )
  )
  (Linear_Seasonal): Linear(32.59 k, 50.000% Params, 27.81 MMac, 49.907% MACs, in_features=96, out_features=336, bias=True)
  (Linear_Trend): Linear(32.59 k, 50.000% Params, 27.81 MMac, 49.907% MACs, in_features=96, out_features=336, bias=True)
)
Computational complexity:       55.71 MMac
Number of parameters:           65.18 k 
mse:0.6060140132904053, mae:0.3744276463985443
