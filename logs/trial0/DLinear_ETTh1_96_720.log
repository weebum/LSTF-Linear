Args in experiment:
Namespace(is_training=1, model_id='Exchange_96_720', model='DLinear', data='custom', root_path='./dataset/', data_path='ETTh1.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=720, individual=False, embed_type=0, enc_in=8, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=True)
Use GPU: cuda:0
>>>>>>>start training : Exchange_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11379
val 1023
test 2765
	iters: 100, epoch: 1 | loss: 0.8888025
	speed: 0.0449s/iter; left time: 634.5699s
	iters: 200, epoch: 1 | loss: 0.5751256
	speed: 0.0046s/iter; left time: 64.5383s
	iters: 300, epoch: 1 | loss: 0.7011504
	speed: 0.0045s/iter; left time: 62.4455s
	iters: 400, epoch: 1 | loss: 0.6669039
	speed: 0.0048s/iter; left time: 65.6540s
	iters: 500, epoch: 1 | loss: 0.6126854
	speed: 0.0045s/iter; left time: 61.9459s
	iters: 600, epoch: 1 | loss: 0.4837398
	speed: 0.0047s/iter; left time: 63.9414s
	iters: 700, epoch: 1 | loss: 0.4848324
	speed: 0.0048s/iter; left time: 64.5887s
	iters: 800, epoch: 1 | loss: 0.6449338
	speed: 0.0046s/iter; left time: 61.2800s
	iters: 900, epoch: 1 | loss: 0.6907076
	speed: 0.0045s/iter; left time: 60.0620s
	iters: 1000, epoch: 1 | loss: 0.5173011
	speed: 0.0035s/iter; left time: 46.0860s
	iters: 1100, epoch: 1 | loss: 0.6970736
	speed: 0.0038s/iter; left time: 49.3112s
	iters: 1200, epoch: 1 | loss: 0.5724974
	speed: 0.0035s/iter; left time: 46.1811s
	iters: 1300, epoch: 1 | loss: 0.5593406
	speed: 0.0036s/iter; left time: 47.1500s
	iters: 1400, epoch: 1 | loss: 0.5555677
	speed: 0.0030s/iter; left time: 37.8403s
Epoch: 1 cost time: 10.02231764793396
Epoch: 1, Steps: 1422 | Train Loss: 0.6424873 Vali Loss: 0.4651812 Test Loss: 0.6539903
Validation loss decreased (inf --> 0.465181).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.8032705
	speed: 0.0562s/iter; left time: 713.1919s
	iters: 200, epoch: 2 | loss: 0.6141752
	speed: 0.0028s/iter; left time: 35.5595s
	iters: 300, epoch: 2 | loss: 0.6704234
	speed: 0.0030s/iter; left time: 37.2460s
	iters: 400, epoch: 2 | loss: 0.5322734
	speed: 0.0029s/iter; left time: 35.7547s
	iters: 500, epoch: 2 | loss: 0.4922684
	speed: 0.0029s/iter; left time: 35.3051s
	iters: 600, epoch: 2 | loss: 0.6700326
	speed: 0.0029s/iter; left time: 35.3924s
	iters: 700, epoch: 2 | loss: 0.6903536
	speed: 0.0030s/iter; left time: 36.5177s
	iters: 800, epoch: 2 | loss: 0.6243451
	speed: 0.0028s/iter; left time: 34.1168s
	iters: 900, epoch: 2 | loss: 0.5705470
	speed: 0.0029s/iter; left time: 35.0870s
	iters: 1000, epoch: 2 | loss: 0.5749289
	speed: 0.0029s/iter; left time: 34.6223s
	iters: 1100, epoch: 2 | loss: 0.5705952
	speed: 0.0028s/iter; left time: 32.9657s
	iters: 1200, epoch: 2 | loss: 0.6267465
	speed: 0.0029s/iter; left time: 33.5619s
	iters: 1300, epoch: 2 | loss: 0.7331942
	speed: 0.0030s/iter; left time: 34.2167s
	iters: 1400, epoch: 2 | loss: 0.5166622
	speed: 0.0028s/iter; left time: 31.9844s
Epoch: 2 cost time: 5.4233009815216064
Epoch: 2, Steps: 1422 | Train Loss: 0.6198580 Vali Loss: 0.5014899 Test Loss: 0.6527682
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.7471563
	speed: 0.0570s/iter; left time: 642.6454s
	iters: 200, epoch: 3 | loss: 0.4324871
	speed: 0.0029s/iter; left time: 31.8950s
	iters: 300, epoch: 3 | loss: 0.6021332
	speed: 0.0032s/iter; left time: 35.3462s
	iters: 400, epoch: 3 | loss: 0.4168049
	speed: 0.0029s/iter; left time: 32.1964s
	iters: 500, epoch: 3 | loss: 0.6839108
	speed: 0.0028s/iter; left time: 30.8677s
	iters: 600, epoch: 3 | loss: 0.5902650
	speed: 0.0031s/iter; left time: 33.4943s
	iters: 700, epoch: 3 | loss: 0.6442068
	speed: 0.0029s/iter; left time: 31.3400s
	iters: 800, epoch: 3 | loss: 0.5393573
	speed: 0.0028s/iter; left time: 30.0528s
	iters: 900, epoch: 3 | loss: 0.6979632
	speed: 0.0031s/iter; left time: 32.3575s
	iters: 1000, epoch: 3 | loss: 0.4623392
	speed: 0.0029s/iter; left time: 30.4313s
	iters: 1100, epoch: 3 | loss: 0.4599785
	speed: 0.0030s/iter; left time: 30.6547s
	iters: 1200, epoch: 3 | loss: 0.6314660
	speed: 0.0032s/iter; left time: 32.4664s
	iters: 1300, epoch: 3 | loss: 0.6961905
	speed: 0.0031s/iter; left time: 31.3345s
	iters: 1400, epoch: 3 | loss: 0.4716667
	speed: 0.0029s/iter; left time: 29.1798s
Epoch: 3 cost time: 5.6230809688568115
Epoch: 3, Steps: 1422 | Train Loss: 0.6154492 Vali Loss: 0.4493961 Test Loss: 0.6455984
Validation loss decreased (0.465181 --> 0.449396).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.4624023
	speed: 0.0541s/iter; left time: 532.7942s
	iters: 200, epoch: 4 | loss: 0.8098028
	speed: 0.0029s/iter; left time: 28.2232s
	iters: 300, epoch: 4 | loss: 0.6771371
	speed: 0.0031s/iter; left time: 30.2034s
	iters: 400, epoch: 4 | loss: 0.7001708
	speed: 0.0029s/iter; left time: 27.3881s
	iters: 500, epoch: 4 | loss: 0.5279677
	speed: 0.0029s/iter; left time: 27.7897s
	iters: 600, epoch: 4 | loss: 0.5852707
	speed: 0.0030s/iter; left time: 28.3372s
	iters: 700, epoch: 4 | loss: 0.4891113
	speed: 0.0029s/iter; left time: 26.5724s
	iters: 800, epoch: 4 | loss: 0.6272897
	speed: 0.0029s/iter; left time: 26.2256s
	iters: 900, epoch: 4 | loss: 0.6116763
	speed: 0.0030s/iter; left time: 27.5423s
	iters: 1000, epoch: 4 | loss: 0.7090768
	speed: 0.0030s/iter; left time: 26.6452s
	iters: 1100, epoch: 4 | loss: 0.5129563
	speed: 0.0029s/iter; left time: 25.6329s
	iters: 1200, epoch: 4 | loss: 0.5985270
	speed: 0.0030s/iter; left time: 26.3354s
	iters: 1300, epoch: 4 | loss: 0.7913579
	speed: 0.0030s/iter; left time: 25.5708s
	iters: 1400, epoch: 4 | loss: 0.6003684
	speed: 0.0028s/iter; left time: 24.3070s
Epoch: 4 cost time: 5.33266019821167
Epoch: 4, Steps: 1422 | Train Loss: 0.6135607 Vali Loss: 0.4839437 Test Loss: 0.6454042
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.6658434
	speed: 0.0564s/iter; left time: 475.8386s
	iters: 200, epoch: 5 | loss: 0.6830935
	speed: 0.0030s/iter; left time: 24.9084s
	iters: 300, epoch: 5 | loss: 0.5926622
	speed: 0.0030s/iter; left time: 24.9786s
	iters: 400, epoch: 5 | loss: 0.6616263
	speed: 0.0028s/iter; left time: 23.1186s
	iters: 500, epoch: 5 | loss: 0.6565900
	speed: 0.0029s/iter; left time: 23.2530s
	iters: 600, epoch: 5 | loss: 0.6341516
	speed: 0.0030s/iter; left time: 23.5059s
	iters: 700, epoch: 5 | loss: 0.6316102
	speed: 0.0028s/iter; left time: 22.1775s
	iters: 800, epoch: 5 | loss: 0.8502394
	speed: 0.0029s/iter; left time: 22.0419s
	iters: 900, epoch: 5 | loss: 0.6116323
	speed: 0.0030s/iter; left time: 22.7340s
	iters: 1000, epoch: 5 | loss: 0.6192579
	speed: 0.0028s/iter; left time: 21.2563s
	iters: 1100, epoch: 5 | loss: 0.5833435
	speed: 0.0028s/iter; left time: 20.9496s
	iters: 1200, epoch: 5 | loss: 0.5534993
	speed: 0.0032s/iter; left time: 23.1453s
	iters: 1300, epoch: 5 | loss: 0.5522582
	speed: 0.0029s/iter; left time: 20.6284s
	iters: 1400, epoch: 5 | loss: 0.6491549
	speed: 0.0030s/iter; left time: 21.0972s
Epoch: 5 cost time: 5.530201435089111
Epoch: 5, Steps: 1422 | Train Loss: 0.6125586 Vali Loss: 0.4752919 Test Loss: 0.6438498
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.6490725
	speed: 0.0579s/iter; left time: 405.9440s
	iters: 200, epoch: 6 | loss: 0.6356946
	speed: 0.0030s/iter; left time: 20.7471s
	iters: 300, epoch: 6 | loss: 0.6142353
	speed: 0.0031s/iter; left time: 20.8455s
	iters: 400, epoch: 6 | loss: 0.5471532
	speed: 0.0028s/iter; left time: 18.9821s
	iters: 500, epoch: 6 | loss: 0.4997360
	speed: 0.0029s/iter; left time: 18.8968s
	iters: 600, epoch: 6 | loss: 0.5213332
	speed: 0.0030s/iter; left time: 19.6818s
	iters: 700, epoch: 6 | loss: 0.7625002
	speed: 0.0028s/iter; left time: 18.1322s
	iters: 800, epoch: 6 | loss: 0.5960070
	speed: 0.0028s/iter; left time: 17.9539s
	iters: 900, epoch: 6 | loss: 0.5466781
	speed: 0.0030s/iter; left time: 18.7701s
	iters: 1000, epoch: 6 | loss: 0.7220456
	speed: 0.0029s/iter; left time: 17.5233s
	iters: 1100, epoch: 6 | loss: 0.8115879
	speed: 0.0029s/iter; left time: 17.5508s
	iters: 1200, epoch: 6 | loss: 0.7345355
	speed: 0.0031s/iter; left time: 18.5146s
	iters: 1300, epoch: 6 | loss: 0.9629399
	speed: 0.0028s/iter; left time: 16.5082s
	iters: 1400, epoch: 6 | loss: 0.5377263
	speed: 0.0029s/iter; left time: 16.4513s
Epoch: 6 cost time: 5.782774209976196
Epoch: 6, Steps: 1422 | Train Loss: 0.6120182 Vali Loss: 0.4789288 Test Loss: 0.6440856
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Exchange_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2765
INFO: Trainable parameter count: 0.07M
INFO: Trainable parameter count: 0.07M
INFO: Trainable parameter count: 0.14M
INFO: Trainable parameter count: 0.14M
Model(
  139.68 k, 100.000% Params, 969.96 KMac, 100.000% MACs, 
  (decompsition): series_decomp(
    0, 0.000% Params, 840.0 Mac, 0.087% MACs, 
    (moving_avg): moving_avg(
      0, 0.000% Params, 840.0 Mac, 0.087% MACs, 
      (avg): AvgPool1d(0, 0.000% Params, 840.0 Mac, 0.087% MACs, kernel_size=(25,), stride=(1,), padding=(0,))
    )
  )
  (Linear_Seasonal): Linear(69.84 k, 50.000% Params, 484.56 KMac, 49.957% MACs, in_features=96, out_features=720, bias=True)
  (Linear_Trend): Linear(69.84 k, 50.000% Params, 484.56 KMac, 49.957% MACs, in_features=96, out_features=720, bias=True)
)
Computational complexity:       969.96 KMac
Number of parameters:           139.68 k
mse:0.6455984115600586, mae:0.5907173156738281
