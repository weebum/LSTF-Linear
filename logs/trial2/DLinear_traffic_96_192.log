Args in experiment:
Namespace(is_training=1, model_id='Exchange_96_192', model='DLinear', data='custom', root_path='./dataset/', data_path='traffic.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=48, pred_len=192, individual=False, embed_type=0, enc_in=8, dec_in=7, c_out=7, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=10, batch_size=8, patience=3, learning_rate=0.0005, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=True)
Use GPU: cuda:0
>>>>>>>start training : Exchange_96_192_DLinear_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11993
val 1565
test 3317
	iters: 100, epoch: 1 | loss: 0.5019556
	speed: 0.0439s/iter; left time: 653.0245s
	iters: 200, epoch: 1 | loss: 0.4474600
	speed: 0.0191s/iter; left time: 282.9691s
	iters: 300, epoch: 1 | loss: 0.4607073
	speed: 0.0199s/iter; left time: 292.2283s
	iters: 400, epoch: 1 | loss: 0.3944913
	speed: 0.0193s/iter; left time: 281.9699s
	iters: 500, epoch: 1 | loss: 0.3653368
	speed: 0.0198s/iter; left time: 287.2554s
	iters: 600, epoch: 1 | loss: 0.3788752
	speed: 0.0197s/iter; left time: 283.2233s
	iters: 700, epoch: 1 | loss: 0.4133701
	speed: 0.0196s/iter; left time: 279.8023s
	iters: 800, epoch: 1 | loss: 0.4241286
	speed: 0.0190s/iter; left time: 269.5399s
	iters: 900, epoch: 1 | loss: 0.3045248
	speed: 0.0201s/iter; left time: 283.5826s
	iters: 1000, epoch: 1 | loss: 0.3421415
	speed: 0.0205s/iter; left time: 287.3334s
	iters: 1100, epoch: 1 | loss: 0.3366228
	speed: 0.0197s/iter; left time: 273.7952s
	iters: 1200, epoch: 1 | loss: 0.3587170
	speed: 0.0197s/iter; left time: 271.6994s
	iters: 1300, epoch: 1 | loss: 0.3658718
	speed: 0.0196s/iter; left time: 268.0964s
	iters: 1400, epoch: 1 | loss: 0.4156642
	speed: 0.0195s/iter; left time: 264.3541s
Epoch: 1 cost time: 31.707793712615967
Epoch: 1, Steps: 1499 | Train Loss: 0.4144864 Vali Loss: 0.5089369 Test Loss: 0.6145234
Validation loss decreased (inf --> 0.508937).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3908472
	speed: 0.2117s/iter; left time: 2835.3615s
	iters: 200, epoch: 2 | loss: 0.3902940
	speed: 0.0196s/iter; left time: 259.9417s
	iters: 300, epoch: 2 | loss: 0.3982305
	speed: 0.0200s/iter; left time: 264.3377s
	iters: 400, epoch: 2 | loss: 0.3310646
	speed: 0.0190s/iter; left time: 249.3522s
	iters: 500, epoch: 2 | loss: 0.3458857
	speed: 0.0193s/iter; left time: 251.3442s
	iters: 600, epoch: 2 | loss: 0.3883187
	speed: 0.0197s/iter; left time: 253.5370s
	iters: 700, epoch: 2 | loss: 0.3528733
	speed: 0.0196s/iter; left time: 250.7507s
	iters: 800, epoch: 2 | loss: 0.3636725
	speed: 0.0191s/iter; left time: 242.3842s
	iters: 900, epoch: 2 | loss: 0.3404607
	speed: 0.0188s/iter; left time: 236.7498s
	iters: 1000, epoch: 2 | loss: 0.3330266
	speed: 0.0192s/iter; left time: 239.7785s
	iters: 1100, epoch: 2 | loss: 0.3827770
	speed: 0.0195s/iter; left time: 241.5959s
	iters: 1200, epoch: 2 | loss: 0.3344292
	speed: 0.0197s/iter; left time: 241.8473s
	iters: 1300, epoch: 2 | loss: 0.3488697
	speed: 0.0196s/iter; left time: 238.5703s
	iters: 1400, epoch: 2 | loss: 0.3410499
	speed: 0.0198s/iter; left time: 239.5310s
Epoch: 2 cost time: 30.8648624420166
Epoch: 2, Steps: 1499 | Train Loss: 0.3627719 Vali Loss: 0.5009146 Test Loss: 0.6051391
Validation loss decreased (0.508937 --> 0.500915).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 3 | loss: 0.3481828
	speed: 0.2199s/iter; left time: 2615.4368s
	iters: 200, epoch: 3 | loss: 0.3755436
	speed: 0.0196s/iter; left time: 231.5423s
	iters: 300, epoch: 3 | loss: 0.3520762
	speed: 0.0197s/iter; left time: 230.5133s
	iters: 400, epoch: 3 | loss: 0.3273332
	speed: 0.0191s/iter; left time: 221.7479s
	iters: 500, epoch: 3 | loss: 0.3179320
	speed: 0.0190s/iter; left time: 218.8552s
	iters: 600, epoch: 3 | loss: 0.3492981
	speed: 0.0194s/iter; left time: 220.8203s
	iters: 700, epoch: 3 | loss: 0.3920637
	speed: 0.0190s/iter; left time: 215.1076s
	iters: 800, epoch: 3 | loss: 0.3750119
	speed: 0.0197s/iter; left time: 220.4115s
	iters: 900, epoch: 3 | loss: 0.3634213
	speed: 0.0198s/iter; left time: 219.2076s
	iters: 1000, epoch: 3 | loss: 0.3163308
	speed: 0.0196s/iter; left time: 215.0233s
	iters: 1100, epoch: 3 | loss: 0.3225849
	speed: 0.0202s/iter; left time: 219.6168s
	iters: 1200, epoch: 3 | loss: 0.3638279
	speed: 0.0198s/iter; left time: 213.9459s
	iters: 1300, epoch: 3 | loss: 0.3617808
	speed: 0.0201s/iter; left time: 214.8561s
	iters: 1400, epoch: 3 | loss: 0.3521856
	speed: 0.0200s/iter; left time: 211.7731s
Epoch: 3 cost time: 31.01528310775757
Epoch: 3, Steps: 1499 | Train Loss: 0.3591636 Vali Loss: 0.4988618 Test Loss: 0.6017994
Validation loss decreased (0.500915 --> 0.498862).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 4 | loss: 0.3315126
	speed: 0.2121s/iter; left time: 2204.3408s
	iters: 200, epoch: 4 | loss: 0.3304999
	speed: 0.0194s/iter; left time: 199.1951s
	iters: 300, epoch: 4 | loss: 0.3331333
	speed: 0.0194s/iter; left time: 198.1120s
	iters: 400, epoch: 4 | loss: 0.3183180
	speed: 0.0197s/iter; left time: 198.5215s
	iters: 500, epoch: 4 | loss: 0.3395812
	speed: 0.0196s/iter; left time: 195.5125s
	iters: 600, epoch: 4 | loss: 0.3654171
	speed: 0.0196s/iter; left time: 194.1524s
	iters: 700, epoch: 4 | loss: 0.3880226
	speed: 0.0199s/iter; left time: 194.4191s
	iters: 800, epoch: 4 | loss: 0.3697478
	speed: 0.0199s/iter; left time: 192.8429s
	iters: 900, epoch: 4 | loss: 0.3776677
	speed: 0.0193s/iter; left time: 185.5853s
	iters: 1000, epoch: 4 | loss: 0.3140294
	speed: 0.0193s/iter; left time: 183.3507s
	iters: 1100, epoch: 4 | loss: 0.3578870
	speed: 0.0195s/iter; left time: 182.9847s
	iters: 1200, epoch: 4 | loss: 0.3252549
	speed: 0.0194s/iter; left time: 180.5019s
	iters: 1300, epoch: 4 | loss: 0.3772743
	speed: 0.0193s/iter; left time: 177.0011s
	iters: 1400, epoch: 4 | loss: 0.3137242
	speed: 0.0202s/iter; left time: 183.5507s
Epoch: 4 cost time: 30.875491857528687
Epoch: 4, Steps: 1499 | Train Loss: 0.3580637 Vali Loss: 0.4966193 Test Loss: 0.6001667
Validation loss decreased (0.498862 --> 0.496619).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 5 | loss: 0.3509349
	speed: 0.2262s/iter; left time: 2012.1084s
	iters: 200, epoch: 5 | loss: 0.3326509
	speed: 0.0196s/iter; left time: 171.9478s
	iters: 300, epoch: 5 | loss: 0.3795213
	speed: 0.0199s/iter; left time: 173.0875s
	iters: 400, epoch: 5 | loss: 0.3460555
	speed: 0.0195s/iter; left time: 167.9477s
	iters: 500, epoch: 5 | loss: 0.3424649
	speed: 0.0188s/iter; left time: 160.0728s
	iters: 600, epoch: 5 | loss: 0.3230839
	speed: 0.0199s/iter; left time: 166.9694s
	iters: 700, epoch: 5 | loss: 0.3609695
	speed: 0.0195s/iter; left time: 161.7597s
	iters: 800, epoch: 5 | loss: 0.3174590
	speed: 0.0195s/iter; left time: 160.1936s
	iters: 900, epoch: 5 | loss: 0.4006259
	speed: 0.0193s/iter; left time: 156.5863s
	iters: 1000, epoch: 5 | loss: 0.3624695
	speed: 0.0194s/iter; left time: 155.2183s
	iters: 1100, epoch: 5 | loss: 0.3363475
	speed: 0.0198s/iter; left time: 156.6480s
	iters: 1200, epoch: 5 | loss: 0.3637677
	speed: 0.0197s/iter; left time: 153.9100s
	iters: 1300, epoch: 5 | loss: 0.3621904
	speed: 0.0201s/iter; left time: 154.8388s
	iters: 1400, epoch: 5 | loss: 0.3592247
	speed: 0.0194s/iter; left time: 147.2496s
Epoch: 5 cost time: 31.10933494567871
Epoch: 5, Steps: 1499 | Train Loss: 0.3575748 Vali Loss: 0.4972738 Test Loss: 0.6004112
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 6 | loss: 0.3394061
	speed: 0.2314s/iter; left time: 1711.2379s
	iters: 200, epoch: 6 | loss: 0.3347303
	speed: 0.0193s/iter; left time: 141.1244s
	iters: 300, epoch: 6 | loss: 0.3548275
	speed: 0.0195s/iter; left time: 140.3071s
	iters: 400, epoch: 6 | loss: 0.3762845
	speed: 0.0192s/iter; left time: 136.3043s
	iters: 500, epoch: 6 | loss: 0.3463469
	speed: 0.0195s/iter; left time: 136.3295s
	iters: 600, epoch: 6 | loss: 0.3812083
	speed: 0.0193s/iter; left time: 133.3017s
	iters: 700, epoch: 6 | loss: 0.4013996
	speed: 0.0193s/iter; left time: 131.4580s
	iters: 800, epoch: 6 | loss: 0.3426092
	speed: 0.0193s/iter; left time: 129.4045s
	iters: 900, epoch: 6 | loss: 0.3506771
	speed: 0.0198s/iter; left time: 130.3963s
	iters: 1000, epoch: 6 | loss: 0.3615851
	speed: 0.0194s/iter; left time: 125.8064s
	iters: 1100, epoch: 6 | loss: 0.3510535
	speed: 0.0194s/iter; left time: 123.9353s
	iters: 1200, epoch: 6 | loss: 0.3616172
	speed: 0.0196s/iter; left time: 123.2242s
	iters: 1300, epoch: 6 | loss: 0.4129245
	speed: 0.0197s/iter; left time: 122.3037s
	iters: 1400, epoch: 6 | loss: 0.3871432
	speed: 0.0193s/iter; left time: 117.8200s
Epoch: 6 cost time: 31.08077120780945
Epoch: 6, Steps: 1499 | Train Loss: 0.3573078 Vali Loss: 0.4967430 Test Loss: 0.5998128
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 7 | loss: 0.3749141
	speed: 0.2213s/iter; left time: 1305.1885s
	iters: 200, epoch: 7 | loss: 0.3261940
	speed: 0.0188s/iter; left time: 108.9308s
	iters: 300, epoch: 7 | loss: 0.3865255
	speed: 0.0193s/iter; left time: 109.9967s
	iters: 400, epoch: 7 | loss: 0.3665912
	speed: 0.0199s/iter; left time: 111.1154s
	iters: 500, epoch: 7 | loss: 0.3099129
	speed: 0.0192s/iter; left time: 105.2847s
	iters: 600, epoch: 7 | loss: 0.3595731
	speed: 0.0201s/iter; left time: 108.6300s
	iters: 700, epoch: 7 | loss: 0.3105153
	speed: 0.0190s/iter; left time: 100.5631s
	iters: 800, epoch: 7 | loss: 0.3933034
	speed: 0.0194s/iter; left time: 100.6338s
	iters: 900, epoch: 7 | loss: 0.3033983
	speed: 0.0190s/iter; left time: 97.0384s
	iters: 1000, epoch: 7 | loss: 0.3881204
	speed: 0.0191s/iter; left time: 95.2746s
	iters: 1100, epoch: 7 | loss: 0.3393169
	speed: 0.0185s/iter; left time: 90.5429s
	iters: 1200, epoch: 7 | loss: 0.3447822
	speed: 0.0183s/iter; left time: 87.7012s
	iters: 1300, epoch: 7 | loss: 0.3550085
	speed: 0.0189s/iter; left time: 88.6823s
	iters: 1400, epoch: 7 | loss: 0.3814009
	speed: 0.0193s/iter; left time: 88.8765s
Epoch: 7 cost time: 30.373494386672974
Epoch: 7, Steps: 1499 | Train Loss: 0.3571912 Vali Loss: 0.4961888 Test Loss: 0.5995188
Validation loss decreased (0.496619 --> 0.496189).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 8 | loss: 0.3964636
	speed: 0.2168s/iter; left time: 953.3067s
	iters: 200, epoch: 8 | loss: 0.4039667
	speed: 0.0195s/iter; left time: 83.8945s
	iters: 300, epoch: 8 | loss: 0.3272520
	speed: 0.0191s/iter; left time: 80.1023s
	iters: 400, epoch: 8 | loss: 0.3727098
	speed: 0.0192s/iter; left time: 78.5427s
	iters: 500, epoch: 8 | loss: 0.3565323
	speed: 0.0194s/iter; left time: 77.7428s
	iters: 600, epoch: 8 | loss: 0.3524405
	speed: 0.0200s/iter; left time: 77.9026s
	iters: 700, epoch: 8 | loss: 0.3104737
	speed: 0.0198s/iter; left time: 75.3028s
	iters: 800, epoch: 8 | loss: 0.3927532
	speed: 0.0197s/iter; left time: 72.8313s
	iters: 900, epoch: 8 | loss: 0.3718181
	speed: 0.0188s/iter; left time: 67.7649s
	iters: 1000, epoch: 8 | loss: 0.3701043
	speed: 0.0195s/iter; left time: 68.1137s
	iters: 1100, epoch: 8 | loss: 0.3902941
	speed: 0.0200s/iter; left time: 67.9221s
	iters: 1200, epoch: 8 | loss: 0.3840543
	speed: 0.0193s/iter; left time: 63.6370s
	iters: 1300, epoch: 8 | loss: 0.3091561
	speed: 0.0195s/iter; left time: 62.2490s
	iters: 1400, epoch: 8 | loss: 0.3509241
	speed: 0.0199s/iter; left time: 61.7882s
Epoch: 8 cost time: 31.0042781829834
Epoch: 8, Steps: 1499 | Train Loss: 0.3571249 Vali Loss: 0.4963490 Test Loss: 0.5995663
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 9 | loss: 0.3406852
	speed: 0.2192s/iter; left time: 635.4175s
	iters: 200, epoch: 9 | loss: 0.3373742
	speed: 0.0196s/iter; left time: 54.7639s
	iters: 300, epoch: 9 | loss: 0.3712001
	speed: 0.0196s/iter; left time: 52.9542s
	iters: 400, epoch: 9 | loss: 0.3525671
	speed: 0.0197s/iter; left time: 51.2983s
	iters: 500, epoch: 9 | loss: 0.3459045
	speed: 0.0194s/iter; left time: 48.5130s
	iters: 600, epoch: 9 | loss: 0.3291706
	speed: 0.0196s/iter; left time: 47.1096s
	iters: 700, epoch: 9 | loss: 0.3612535
	speed: 0.0195s/iter; left time: 44.7509s
	iters: 800, epoch: 9 | loss: 0.3819866
	speed: 0.0194s/iter; left time: 42.7339s
	iters: 900, epoch: 9 | loss: 0.3494207
	speed: 0.0197s/iter; left time: 41.4383s
	iters: 1000, epoch: 9 | loss: 0.3647346
	speed: 0.0198s/iter; left time: 39.5707s
	iters: 1100, epoch: 9 | loss: 0.3551526
	speed: 0.0190s/iter; left time: 36.1624s
	iters: 1200, epoch: 9 | loss: 0.3243029
	speed: 0.0201s/iter; left time: 36.1502s
	iters: 1300, epoch: 9 | loss: 0.3443789
	speed: 0.0198s/iter; left time: 33.5564s
	iters: 1400, epoch: 9 | loss: 0.3426833
	speed: 0.0198s/iter; left time: 31.5892s
Epoch: 9 cost time: 31.20359468460083
Epoch: 9, Steps: 1499 | Train Loss: 0.3570829 Vali Loss: 0.4961466 Test Loss: 0.5994715
Validation loss decreased (0.496189 --> 0.496147).  Saving model ...
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 10 | loss: 0.3269687
	speed: 0.2239s/iter; left time: 313.4515s
	iters: 200, epoch: 10 | loss: 0.3670439
	speed: 0.0196s/iter; left time: 25.4646s
	iters: 300, epoch: 10 | loss: 0.3037172
	speed: 0.0199s/iter; left time: 23.8417s
	iters: 400, epoch: 10 | loss: 0.3403007
	speed: 0.0196s/iter; left time: 21.5262s
	iters: 500, epoch: 10 | loss: 0.3652852
	speed: 0.0190s/iter; left time: 19.0403s
	iters: 600, epoch: 10 | loss: 0.4045626
	speed: 0.0195s/iter; left time: 17.5342s
	iters: 700, epoch: 10 | loss: 0.3741290
	speed: 0.0193s/iter; left time: 15.4300s
	iters: 800, epoch: 10 | loss: 0.3701153
	speed: 0.0196s/iter; left time: 13.7507s
	iters: 900, epoch: 10 | loss: 0.3758515
	speed: 0.0196s/iter; left time: 11.7648s
	iters: 1000, epoch: 10 | loss: 0.3398818
	speed: 0.0199s/iter; left time: 9.9376s
	iters: 1100, epoch: 10 | loss: 0.3361978
	speed: 0.0202s/iter; left time: 8.0930s
	iters: 1200, epoch: 10 | loss: 0.3309004
	speed: 0.0203s/iter; left time: 6.1027s
	iters: 1300, epoch: 10 | loss: 0.3229175
	speed: 0.0191s/iter; left time: 3.8100s
	iters: 1400, epoch: 10 | loss: 0.3448344
	speed: 0.0193s/iter; left time: 1.9296s
Epoch: 10 cost time: 31.049034357070923
Epoch: 10, Steps: 1499 | Train Loss: 0.3570691 Vali Loss: 0.4961561 Test Loss: 0.5994554
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.765625e-07
>>>>>>>testing : Exchange_96_192_DLinear_custom_ftM_sl96_ll48_pl192_dm512_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3317
mse:0.599470853805542, mae:0.3717483878135681
INFO: Trainable parameter count: 0.02M
INFO: Trainable parameter count: 0.02M
INFO: Trainable parameter count: 0.04M
INFO: Trainable parameter count: 0.04M
